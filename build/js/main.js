"use strict";

document.addEventListener("DOMContentLoaded", function () {
  var stageTabs = document.querySelectorAll(".predict__tabs-item"),
    stageWraps = document.querySelectorAll(".predict__stage"),
    loseCards = document.querySelectorAll(".predict__lose-card"),
    loseCardsTeams = document.querySelectorAll(".predict__lose-team"),
    winCards = document.querySelectorAll(".predict__win-card"),
    winCardsTeams = document.querySelectorAll(".predict__win-team"),
    predictOverlay = document.querySelector(".predict__overlay"),
    predictPopups = predictOverlay.querySelectorAll(".predict__teams"),
    predictTeams = predictOverlay.querySelectorAll(".predict__teams-item"),
    predictBtns = document.querySelectorAll(".cards-btn"),
    predictList = document.querySelectorAll(".predict__list"),
    predictListItem = document.querySelectorAll(".predict__list-item");

  // console.log(predictBtns)

  var currentCard;
  // let setStatus;

  function setPopup(overlay, btns, popups, btnWraps) {
    btns.forEach(function (btn, i) {
      btn.addEventListener("click", function (e) {
        var predictBtns = document.querySelectorAll(".cards-btn"),
          targetClick = true;
        // console.log(predictBtns)
        predictBtns.forEach(function (predictBtn) {
          var storageData = e.target.parentElement.getAttribute("data-storage");
          if (predictBtn === e.target && storageData !== null) {
            targetClick = false;
            e.target.parentElement.removeAttribute("data-storage");
          }
          return targetClick;
        });
        if (targetClick) {
          var index;
          btnWraps.forEach(function (wrap, i) {
            if (btn.parentElement === wrap) {
              return index = i;
            }
          });
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopup(predictOverlay, predictListItem, predictPopups, predictList);
  function showPopup(popups, overlay, index) {
    popups.forEach(function (popup) {
      return popup.classList.remove("_active");
    });
    overlay.classList.add("_active");
    popups[index].classList.add("_active");
    document.body.style.overflow = "hidden";
    var closeBtn = popups[index].querySelector(".predict__teams-close");
    closeBtn.addEventListener("click", function () {
      overlay.classList.remove("_active");
      popups[index].classList.remove("_active");
      document.body.style.overflow = "auto";
    }, {
      once: true
    });
  }
  function setPopupWinLose(overlay, btns, popups, predictBtns) {
    btns.forEach(function (btn, index) {
      btn.addEventListener("click", function (e) {
        var targetClick = true;
        predictBtns.forEach(function (predictBtn) {
          if (predictBtn.classList === e.target.classList) {
            targetClick = false;
          }
          return targetClick;
        });
        if (targetClick) {
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopupWinLose(predictOverlay, winCards, predictPopups, predictBtns);
  setPopupWinLose(predictOverlay, loseCards, predictPopups, predictBtns);
  function setTeam(teams, cardsText, overlay, popups, status) {
    if (status) {
      var cards = [];
      cardsText.forEach(function (item) {
        cards.push(item.parentElement.classList[1]);
      });
      cards.forEach(function (card, i) {
        var key = "selectedTeam-".concat(card, "-").concat(status);
        if (localStorage.getItem(key)) {
          cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
          cardsText[i].parentElement.parentElement.classList.remove("_select");
          if (cardsText[i].innerText.trim() !== '') {
            cardsText[i].parentElement.parentElement.classList.add("_select");
            cardsText[i].parentElement.parentElement.setAttribute('data-storage', key);
          }
        }
      });
      teams.forEach(function (team) {
        team.addEventListener("click", function (e) {
          // const teamParent = team.parentElement.parentElement;
          var teamName = team.querySelector(".team-name").textContent;
          cards.forEach(function (card, i) {
            if (currentCard === cardsText[i].parentElement) {
              var key = "selectedTeam-".concat(card, "-").concat(status);
              currentCard.parentElement.classList.add("_select");
              currentCard.parentElement.setAttribute('data-storage', key);
              localStorage.setItem(key, "".concat(teamName));
              cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
              overlay.classList.remove("_active");
              popups.forEach(function (popup) {
                return popup.classList.remove("_active");
              });
              document.body.style.overflow = "auto";
            }
          });
        });
      });
    } else {
      var cardsTextLists = [];
      cardsText.forEach(function (item) {
        return cardsTextLists.push(item);
      });
      cardsTextLists.forEach(function (list, listIndex) {
        list.childNodes.forEach(function (item, i) {
          var stage = list.getAttribute("data-stage"),
            key = "selectedTeam-".concat(stage, "-card").concat(++i),
            teamTextBlock = item.querySelector(".".concat(item.classList[0], "-team"));
          teams.forEach(function (team) {
            team.addEventListener("click", function (e) {
              if (item === currentCard) {
                var teamName = team.querySelector(".team-name").textContent;
                currentCard.classList.add("_select");
                currentCard.setAttribute('data-storage', key);
                localStorage.setItem(key, "".concat(teamName));
                // console.log(item)
                teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
                overlay.classList.remove("_active");
                popups.forEach(function (popup) {
                  return popup.classList.remove("_active");
                });
                document.body.style.overflow = "auto";
              }
            });
          });
          if (localStorage.getItem(key)) {
            console.log("key");
            teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
            teamTextBlock.parentElement.parentElement.classList.remove("_select");
            if (teamTextBlock.innerText.trim() !== '') {
              teamTextBlock.parentElement.classList.add("_select");
              teamTextBlock.parentElement.setAttribute('data-storage', key);
            }
          }
        });
      });
    }
  }
  setTeam(predictTeams, winCardsTeams, predictOverlay, predictPopups, "win");
  setTeam(predictTeams, loseCardsTeams, predictOverlay, predictPopups, "lose");
  setTeam(predictTeams, predictList, predictOverlay, predictPopups, null);
  function removeTeam(removeBtns, listState) {
    removeBtns.forEach(function (removeBtn) {
      removeBtn.addEventListener("click", function () {
        var btnParent = removeBtn.parentElement.parentElement,
          dataBtn = btnParent.getAttribute("data-storage");

        // console.log(dataBtn)
        if (!dataBtn) {
          btnParent = removeBtn.parentElement;
          dataBtn = btnParent.getAttribute("data-storage");
        }
        localStorage.removeItem(dataBtn);
        btnParent.classList.remove("_select");
      });
    });
  }

  // removeTeam(predictBtns)
  removeTeam(predictBtns);
  stageTabs.forEach(function (tab, tabIndex) {
    tab.addEventListener("click", function (e) {
      stageTabs.forEach(function (tab, i) {
        tab.classList.remove("_active");
      });
      stageWraps.forEach(function (item, stageIndex) {
        item.classList.remove("_active");
        if (tabIndex === stageIndex) {
          item.classList.add("_active");
          if (item.classList.contains("stage3")) {
            item.parentElement.classList.add('stage3');
          } else {
            item.parentElement.classList.remove('stage3');
          }
        }
      });
      e.target.classList.add("_active");
    });
  });

  // countdown timer
  function startCountdown(element) {
    var targetDate = new Date(element.getAttribute('data-target-date'));
    function updateCountdown() {
      var now = new Date(),
        difference = targetDate - now;
      if (difference <= 0) {
        element.querySelector('.predict__info-lock-countdown').textContent = "time over";
        clearInterval(countdownInterval);
        return;
      }
      var days = Math.floor(difference / (1000 * 60 * 60 * 24)),
        hours = Math.floor(difference % (1000 * 60 * 60 * 24) / (1000 * 60 * 60)),
        minutes = Math.floor(difference % (1000 * 60 * 60) / (1000 * 60));
      element.querySelector('.predict__info-lock-days').textContent = days;
      element.querySelector('.predict__info-lock-hours').textContent = hours;
      element.querySelector('.predict__info-lock-minutes').textContent = minutes;
    }
    var countdownInterval = setInterval(updateCountdown, 60000);
    updateCountdown();
  }
  document.querySelectorAll('.predict__info-lock-countdown').forEach(startCountdown);

  // custom horizontal scroll
  var scrollBar = document.querySelector(".table__scrollbar"),
    scrollBarThumb = document.querySelector(".table__scrollbar-thumb"),
    scrollElem = document.querySelector('.table__wrap-scroll'),
    scrollContainer = document.querySelector('.table__wrap');
  var scrollBarWidth = scrollContainer.clientWidth - 50,
    scrollBarThumbWidth;
  if (scrollElem.clientWidth <= scrollContainer.clientWidth) {
    scrollBar.style.display = "none";
  } else {
    scrollBar.style.display = "block";
    scrollBarThumbWidth = (scrollBarWidth * scrollContainer.clientWidth - 50) / scrollElem.scrollWidth;
    scrollBarThumb.style.width = "".concat(scrollBarThumbWidth, "px");
    scrollBar.style.width = "".concat(scrollBarWidth, "px");
  }
  var currentScrollDistance = 0;
  scrollContainer.addEventListener("scroll", function () {
    currentScrollDistance = scrollContainer.scrollLeft * 100 / scrollContainer.clientWidth;
    scrollBarThumb.style.left = "".concat(scrollBarThumbWidth / 100 * currentScrollDistance - 5, "px");
  });
  // typewright text anim
  function dynamicTypewriter(element, speed, callback) {
    var textArray = element.textContent.trim().split(' ');
    var litArr = textArray.join(' ').split(/(\s+)/).filter(function (_char) {
      return _char.trim() !== '' || _char === ' ';
    });
    var wordIndex = 0;
    var charIndex = 0;
    var currentText = '';
    element.classList.add("_opacity");
    function typeWord() {
      if (wordIndex === litArr.length) {
        element.classList.remove('typewriter-cursor');
        return;
      }
      var currentWord = textArray[wordIndex];
      if (currentWord === undefined) return;
      if (charIndex < currentWord.length) {
        currentText += currentWord.charAt(charIndex);
        element.innerText = currentText;
        charIndex++;
        setTimeout(typeWord, speed);
      } else {
        currentText += ' ';
        element.innerText = currentText;
        charIndex = 0;
        wordIndex++;
        setTimeout(typeWord, speed);
      }
    }
    element.classList.add('typewriter-cursor');
    typeWord();
  }
  function observeElements(typeElems) {
    var options = {
      root: null,
      threshold: 0.5
    };
    var observer = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry, i) {
        if (entry.isIntersecting) {
          dynamicTypewriter(entry.target, 35, function () {});
          observer.unobserve(entry.target);
        }
      });
    }, options);
    typeElems.forEach(function (item) {
      observer.observe(item);
    });
  }
  var typeAnim = document.querySelectorAll('.type-anim');
  observeElements(typeAnim);
  document.querySelector(".dark-btn").addEventListener("click", function () {
    document.body.classList.toggle("dark");
  });
  var arr = {
    a: 1,
    b: 2,
    c: 3,
    g: 4
  };
  for (var item in arr) {
    console.log(arr[item]);
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhZ2VUYWJzIiwicXVlcnlTZWxlY3RvckFsbCIsInN0YWdlV3JhcHMiLCJsb3NlQ2FyZHMiLCJsb3NlQ2FyZHNUZWFtcyIsIndpbkNhcmRzIiwid2luQ2FyZHNUZWFtcyIsInByZWRpY3RPdmVybGF5IiwicXVlcnlTZWxlY3RvciIsInByZWRpY3RQb3B1cHMiLCJwcmVkaWN0VGVhbXMiLCJwcmVkaWN0QnRucyIsInByZWRpY3RMaXN0IiwicHJlZGljdExpc3RJdGVtIiwiY3VycmVudENhcmQiLCJzZXRQb3B1cCIsIm92ZXJsYXkiLCJidG5zIiwicG9wdXBzIiwiYnRuV3JhcHMiLCJmb3JFYWNoIiwiYnRuIiwiaSIsImUiLCJ0YXJnZXRDbGljayIsInByZWRpY3RCdG4iLCJzdG9yYWdlRGF0YSIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbmRleCIsIndyYXAiLCJzaG93UG9wdXAiLCJwb3B1cCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93IiwiY2xvc2VCdG4iLCJvbmNlIiwic2V0UG9wdXBXaW5Mb3NlIiwic2V0VGVhbSIsInRlYW1zIiwiY2FyZHNUZXh0Iiwic3RhdHVzIiwiY2FyZHMiLCJpdGVtIiwicHVzaCIsImNhcmQiLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaW5uZXJIVE1MIiwiaW5uZXJUZXh0IiwidHJpbSIsInNldEF0dHJpYnV0ZSIsInRlYW0iLCJ0ZWFtTmFtZSIsInRleHRDb250ZW50Iiwic2V0SXRlbSIsImNhcmRzVGV4dExpc3RzIiwibGlzdCIsImxpc3RJbmRleCIsImNoaWxkTm9kZXMiLCJzdGFnZSIsInRlYW1UZXh0QmxvY2siLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlVGVhbSIsInJlbW92ZUJ0bnMiLCJsaXN0U3RhdGUiLCJyZW1vdmVCdG4iLCJidG5QYXJlbnQiLCJkYXRhQnRuIiwicmVtb3ZlSXRlbSIsInRhYiIsInRhYkluZGV4Iiwic3RhZ2VJbmRleCIsImNvbnRhaW5zIiwic3RhcnRDb3VudGRvd24iLCJlbGVtZW50IiwidGFyZ2V0RGF0ZSIsIkRhdGUiLCJ1cGRhdGVDb3VudGRvd24iLCJub3ciLCJkaWZmZXJlbmNlIiwiY2xlYXJJbnRlcnZhbCIsImNvdW50ZG93bkludGVydmFsIiwiZGF5cyIsIk1hdGgiLCJmbG9vciIsImhvdXJzIiwibWludXRlcyIsInNldEludGVydmFsIiwic2Nyb2xsQmFyIiwic2Nyb2xsQmFyVGh1bWIiLCJzY3JvbGxFbGVtIiwic2Nyb2xsQ29udGFpbmVyIiwic2Nyb2xsQmFyV2lkdGgiLCJjbGllbnRXaWR0aCIsInNjcm9sbEJhclRodW1iV2lkdGgiLCJkaXNwbGF5Iiwic2Nyb2xsV2lkdGgiLCJ3aWR0aCIsImN1cnJlbnRTY3JvbGxEaXN0YW5jZSIsInNjcm9sbExlZnQiLCJsZWZ0IiwiZHluYW1pY1R5cGV3cml0ZXIiLCJzcGVlZCIsImNhbGxiYWNrIiwidGV4dEFycmF5Iiwic3BsaXQiLCJsaXRBcnIiLCJqb2luIiwiZmlsdGVyIiwiX2NoYXIiLCJ3b3JkSW5kZXgiLCJjaGFySW5kZXgiLCJjdXJyZW50VGV4dCIsInR5cGVXb3JkIiwibGVuZ3RoIiwiY3VycmVudFdvcmQiLCJ1bmRlZmluZWQiLCJjaGFyQXQiLCJzZXRUaW1lb3V0Iiwib2JzZXJ2ZUVsZW1lbnRzIiwidHlwZUVsZW1zIiwib3B0aW9ucyIsInJvb3QiLCJ0aHJlc2hvbGQiLCJvYnNlcnZlciIsIkludGVyc2VjdGlvbk9ic2VydmVyIiwiZW50cmllcyIsImVudHJ5IiwiaXNJbnRlcnNlY3RpbmciLCJ1bm9ic2VydmUiLCJvYnNlcnZlIiwidHlwZUFuaW0iLCJ0b2dnbGUiLCJhcnIiLCJhIiwiYiIsImMiLCJnIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxRQUFRLENBQUNDLGdCQUFnQixDQUFDLGtCQUFrQixF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QUcsQ0FBQzdGLElBQUksQ0FBQyxDQUFDO0VBQzFCO0FBRUosQ0FBQyxDQUFDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKT0+e1xuICAgIGNvbnN0IHN0YWdlVGFicyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fdGFicy1pdGVtXCIpLFxuICAgICAgICAgIHN0YWdlV3JhcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3N0YWdlXCIpLFxuICAgICAgICAgIGxvc2VDYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbG9zZS1jYXJkXCIpLFxuICAgICAgICAgIGxvc2VDYXJkc1RlYW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X19sb3NlLXRlYW1cIiksXG4gICAgICAgICAgd2luQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3dpbi1jYXJkXCIpLFxuICAgICAgICAgIHdpbkNhcmRzVGVhbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3dpbi10ZWFtXCIpLFxuICAgICAgICAgIHByZWRpY3RPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmVkaWN0X19vdmVybGF5XCIpLFxuICAgICAgICAgIHByZWRpY3RQb3B1cHMgPSBwcmVkaWN0T3ZlcmxheS5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3RlYW1zXCIpLFxuICAgICAgICAgIHByZWRpY3RUZWFtcyA9IHByZWRpY3RPdmVybGF5LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fdGVhbXMtaXRlbVwiKSxcbiAgICAgICAgICBwcmVkaWN0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FyZHMtYnRuXCIpLFxuICAgICAgICAgIHByZWRpY3RMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X19saXN0XCIpLFxuICAgICAgICAgIHByZWRpY3RMaXN0SXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbGlzdC1pdGVtXCIpXG5cbiAgICAvLyBjb25zb2xlLmxvZyhwcmVkaWN0QnRucylcblxuICAgIGxldCBjdXJyZW50Q2FyZDtcbiAgICAvLyBsZXQgc2V0U3RhdHVzO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRQb3B1cChvdmVybGF5LCBidG5zLCBwb3B1cHMsICBidG5XcmFwcykge1xuICAgICAgICBidG5zLmZvckVhY2goKGJ0biwgaSkgPT4ge1xuICAgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBwcmVkaWN0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FyZHMtYnRuXCIpLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGljayA9IHRydWVcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcmVkaWN0QnRucylcbiAgICAgICAgICAgICAgICBwcmVkaWN0QnRucy5mb3JFYWNoKHByZWRpY3RCdG4gPT57XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9yYWdlRGF0YSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zdG9yYWdlXCIpXG4gICAgICAgICAgICAgICAgICAgIGlmKHByZWRpY3RCdG4gPT09IGUudGFyZ2V0ICYmIHN0b3JhZ2VEYXRhICE9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldENsaWNrID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1zdG9yYWdlXCIpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldENsaWNrXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZih0YXJnZXRDbGljayl7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgYnRuV3JhcHMuZm9yRWFjaCgod3JhcCwgaSkgPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihidG4ucGFyZW50RWxlbWVudCA9PT0gd3JhcCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4ID0gaVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBzaG93UG9wdXAocG9wdXBzLCBvdmVybGF5LCBpbmRleClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRDYXJkID0gYnRuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldFBvcHVwKHByZWRpY3RPdmVybGF5LCBwcmVkaWN0TGlzdEl0ZW0sIHByZWRpY3RQb3B1cHMsIHByZWRpY3RMaXN0KVxuXG5cbiAgICBmdW5jdGlvbiBzaG93UG9wdXAocG9wdXBzLCBvdmVybGF5LCBpbmRleCl7XG4gICAgICAgIHBvcHVwcy5mb3JFYWNoKHBvcHVwID0+IHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpKTtcbiAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgcG9wdXBzW2luZGV4XS5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCJcbiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBwb3B1cHNbaW5kZXhdLnF1ZXJ5U2VsZWN0b3IoXCIucHJlZGljdF9fdGVhbXMtY2xvc2VcIik7XG4gICAgICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpO1xuICAgICAgICAgICAgcG9wdXBzW2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIlxuICAgICAgICB9LCB7IG9uY2U6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0UG9wdXBXaW5Mb3NlKG92ZXJsYXksIGJ0bnMsIHBvcHVwcywgcHJlZGljdEJ0bnMpIHtcbiAgICAgICAgYnRucy5mb3JFYWNoKChidG4sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHRhcmdldENsaWNrID0gdHJ1ZVxuICAgICAgICAgICAgICAgIHByZWRpY3RCdG5zLmZvckVhY2gocHJlZGljdEJ0biA9PntcbiAgICAgICAgICAgICAgICAgICAgaWYocHJlZGljdEJ0bi5jbGFzc0xpc3QgPT09IGUudGFyZ2V0LmNsYXNzTGlzdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGljayA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldENsaWNrXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZih0YXJnZXRDbGljayl7XG4gICAgICAgICAgICAgICAgICAgIHNob3dQb3B1cChwb3B1cHMsIG92ZXJsYXksIGluZGV4KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudENhcmQgPSBidG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldFBvcHVwV2luTG9zZShwcmVkaWN0T3ZlcmxheSwgd2luQ2FyZHMsIHByZWRpY3RQb3B1cHMsIHByZWRpY3RCdG5zKVxuICAgIHNldFBvcHVwV2luTG9zZShwcmVkaWN0T3ZlcmxheSwgbG9zZUNhcmRzLCBwcmVkaWN0UG9wdXBzLCBwcmVkaWN0QnRucylcblxuXG5cbiAgICBmdW5jdGlvbiBzZXRUZWFtKHRlYW1zLCBjYXJkc1RleHQsIG92ZXJsYXksIHBvcHVwcywgc3RhdHVzKSB7XG4gICAgICAgIGlmKHN0YXR1cyl7XG4gICAgICAgICAgICBsZXQgY2FyZHMgPSBbXTtcbiAgICAgICAgICAgIGNhcmRzVGV4dC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGNhcmRzLnB1c2goaXRlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdFsxXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhcmRzLmZvckVhY2goKGNhcmQsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQga2V5ID0gYHNlbGVjdGVkVGVhbS0ke2NhcmR9LSR7c3RhdHVzfWA7XG4gICAgICAgICAgICAgICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzVGV4dFtpXS5pbm5lckhUTUwgPSBg0JrQvtC80LDQvdC00LAgPGJyPiAke2xvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSl9YDtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNUZXh0W2ldLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1RleHRbaV0uaW5uZXJUZXh0LnRyaW0oKSAhPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNUZXh0W2ldLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNUZXh0W2ldLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcmFnZScsIGtleSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0ZWFtcy5mb3JFYWNoKCh0ZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgdGVhbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgdGVhbVBhcmVudCA9IHRlYW0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtTmFtZSA9IHRlYW0ucXVlcnlTZWxlY3RvcihcIi50ZWFtLW5hbWVcIikudGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzLmZvckVhY2goKGNhcmQsIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q2FyZCA9PT0gY2FyZHNUZXh0W2ldLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gYHNlbGVjdGVkVGVhbS0ke2NhcmR9LSR7c3RhdHVzfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENhcmQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkLnBhcmVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXN0b3JhZ2UnLCBrZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBgJHt0ZWFtTmFtZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkc1RleHRbaV0uaW5uZXJIVE1MID0gYNCa0L7QvNCw0L3QtNCwIDxicj4gJHt0ZWFtTmFtZX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBzLmZvckVhY2gocG9wdXAgPT4gcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBsZXQgY2FyZHNUZXh0TGlzdHMgPSBbXVxuICAgICAgICAgICAgY2FyZHNUZXh0LmZvckVhY2goaXRlbSA9PntcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FyZHNUZXh0TGlzdHMucHVzaChpdGVtKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNhcmRzVGV4dExpc3RzLmZvckVhY2goKGxpc3QsIGxpc3RJbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGxpc3QuY2hpbGROb2Rlcy5mb3JFYWNoKChpdGVtLCBpKSA9PntcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YWdlID0gbGlzdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YWdlXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gYHNlbGVjdGVkVGVhbS0ke3N0YWdlfS1jYXJkJHsrK2l9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2sgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoYC4ke2l0ZW0uY2xhc3NMaXN0WzBdfS10ZWFtYClcbiAgICAgICAgICAgICAgICAgICAgdGVhbXMuZm9yRWFjaCgodGVhbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVhbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtID09PSBjdXJyZW50Q2FyZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlYW1OYW1lID0gdGVhbS5xdWVyeVNlbGVjdG9yKFwiLnRlYW0tbmFtZVwiKS50ZXh0Q29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2FyZC5jbGFzc0xpc3QuYWRkKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2FyZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcmFnZScsIGtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBgJHt0ZWFtTmFtZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaXRlbSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jay5pbm5lckhUTUwgPSBg0JrQvtC80LDQvdC00LAgPGJyPiAke3RlYW1OYW1lfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwcy5mb3JFYWNoKHBvcHVwID0+IHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiYXV0b1wiXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJrZXlcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2suaW5uZXJIVE1MID0gYNCa0L7QvNCw0L3QtNCwIDxicj4gJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZWFtVGV4dEJsb2NrLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodGVhbVRleHRCbG9jay5pbm5lclRleHQudHJpbSgpICE9PSAnJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jay5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jay5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yYWdlJywga2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIHNldFRlYW0ocHJlZGljdFRlYW1zLCB3aW5DYXJkc1RlYW1zLCBwcmVkaWN0T3ZlcmxheSwgcHJlZGljdFBvcHVwcywgXCJ3aW5cIik7XG4gICAgc2V0VGVhbShwcmVkaWN0VGVhbXMsIGxvc2VDYXJkc1RlYW1zLCBwcmVkaWN0T3ZlcmxheSwgcHJlZGljdFBvcHVwcywgXCJsb3NlXCIpO1xuICAgIHNldFRlYW0ocHJlZGljdFRlYW1zLCBwcmVkaWN0TGlzdCwgcHJlZGljdE92ZXJsYXksIHByZWRpY3RQb3B1cHMsIG51bGwpO1xuXG4gICAgZnVuY3Rpb24gcmVtb3ZlVGVhbShyZW1vdmVCdG5zLCBsaXN0U3RhdGUpe1xuICAgICAgICByZW1vdmVCdG5zLmZvckVhY2gocmVtb3ZlQnRuID0+e1xuICAgICAgICAgICAgcmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICAgICAgICAgICAgICBsZXQgYnRuUGFyZW50ID0gIHJlbW92ZUJ0bi5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFCdG4gPSBidG5QYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zdG9yYWdlXCIpXG5cbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhQnRuKVxuICAgICAgICAgICAgICAgIGlmKCFkYXRhQnRuKXtcbiAgICAgICAgICAgICAgICAgICAgYnRuUGFyZW50ID0gcmVtb3ZlQnRuLnBhcmVudEVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgZGF0YUJ0biA9IGJ0blBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXN0b3JhZ2VcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZGF0YUJ0bilcbiAgICAgICAgICAgICAgICBidG5QYXJlbnQuY2xhc3NMaXN0LnJlbW92ZShcIl9zZWxlY3RcIilcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyByZW1vdmVUZWFtKHByZWRpY3RCdG5zKVxuICAgIHJlbW92ZVRlYW0ocHJlZGljdEJ0bnMpXG5cbiAgICBzdGFnZVRhYnMuZm9yRWFjaCgodGFiLCB0YWJJbmRleCkgPT57XG4gICAgICAgIHRhYi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+e1xuICAgICAgICAgICAgc3RhZ2VUYWJzLmZvckVhY2goKHRhYiwgaSkgPT57XG4gICAgICAgICAgICAgIHRhYi5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHN0YWdlV3JhcHMuZm9yRWFjaCgoaXRlbSwgc3RhZ2VJbmRleCkgPT57XG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKVxuICAgICAgICAgICAgICAgIGlmKHRhYkluZGV4ID09PSBzdGFnZUluZGV4KXtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKVxuICAgICAgICAgICAgICAgICAgICBpZihpdGVtLmNsYXNzTGlzdC5jb250YWlucyhcInN0YWdlM1wiKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc3RhZ2UzJylcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc3RhZ2UzJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKVxuICAgICAgICB9KVxuICAgIH0pXG5cbi8vIGNvdW50ZG93biB0aW1lclxuICAgIGZ1bmN0aW9uIHN0YXJ0Q291bnRkb3duKGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0RGF0ZSA9IG5ldyBEYXRlKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldC1kYXRlJykpXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUNvdW50ZG93bigpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgICBkaWZmZXJlbmNlID0gdGFyZ2V0RGF0ZSAtIG5vd1xuICAgICAgICAgICAgaWYgKGRpZmZlcmVuY2UgPD0gMCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZWRpY3RfX2luZm8tbG9jay1jb3VudGRvd24nKS50ZXh0Q29udGVudCA9IFwidGltZSBvdmVyXCJcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGNvdW50ZG93bkludGVydmFsKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZGF5cyA9IE1hdGguZmxvb3IoZGlmZmVyZW5jZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSksXG4gICAgICAgICAgICAgICAgICBob3VycyA9IE1hdGguZmxvb3IoKGRpZmZlcmVuY2UgJSAoMTAwMCAqIDYwICogNjAgKiAyNCkpIC8gKDEwMDAgKiA2MCAqIDYwKSksXG4gICAgICAgICAgICAgICAgICBtaW51dGVzID0gTWF0aC5mbG9vcigoZGlmZmVyZW5jZSAlICgxMDAwICogNjAgKiA2MCkpIC8gKDEwMDAgKiA2MCkpXG4gICAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVkaWN0X19pbmZvLWxvY2stZGF5cycpLnRleHRDb250ZW50ID0gZGF5c1xuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucHJlZGljdF9faW5mby1sb2NrLWhvdXJzJykudGV4dENvbnRlbnQgPSBob3Vyc1xuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucHJlZGljdF9faW5mby1sb2NrLW1pbnV0ZXMnKS50ZXh0Q29udGVudCA9IG1pbnV0ZXNcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb3VudGRvd25JbnRlcnZhbCA9IHNldEludGVydmFsKHVwZGF0ZUNvdW50ZG93biwgNjAwMDApXG4gICAgICAgIHVwZGF0ZUNvdW50ZG93bigpXG4gICAgfVxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcmVkaWN0X19pbmZvLWxvY2stY291bnRkb3duJykuZm9yRWFjaChzdGFydENvdW50ZG93bilcblxuICAgIC8vIGN1c3RvbSBob3Jpem9udGFsIHNjcm9sbFxuICAgIGNvbnN0IHNjcm9sbEJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX3Njcm9sbGJhclwiKSxcbiAgICAgICAgICBzY3JvbGxCYXJUaHVtYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFibGVfX3Njcm9sbGJhci10aHVtYlwiKSxcbiAgICAgICAgICBzY3JvbGxFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYmxlX193cmFwLXNjcm9sbCcpLFxuICAgICAgICAgIHNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJsZV9fd3JhcCcpXG5cbiAgICBsZXQgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGggLSA1MCxcbiAgICAgICAgc2Nyb2xsQmFyVGh1bWJXaWR0aDtcblxuICAgIGlmIChzY3JvbGxFbGVtLmNsaWVudFdpZHRoIDw9IHNjcm9sbENvbnRhaW5lci5jbGllbnRXaWR0aCkge1xuICAgICAgICBzY3JvbGxCYXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgc2Nyb2xsQmFyVGh1bWJXaWR0aCA9IChzY3JvbGxCYXJXaWR0aCAqIHNjcm9sbENvbnRhaW5lci5jbGllbnRXaWR0aCAtIDUwKSAvIHNjcm9sbEVsZW0uc2Nyb2xsV2lkdGhcbiAgICAgICAgc2Nyb2xsQmFyVGh1bWIuc3R5bGUud2lkdGggPSBgJHtzY3JvbGxCYXJUaHVtYldpZHRofXB4YFxuICAgICAgICBzY3JvbGxCYXIuc3R5bGUud2lkdGggPSBgJHtzY3JvbGxCYXJXaWR0aH1weGBcbiAgICB9XG5cbiAgICBsZXQgY3VycmVudFNjcm9sbERpc3RhbmNlID0gMFxuXG4gICAgc2Nyb2xsQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgKCkgPT4ge1xuICAgICAgICBjdXJyZW50U2Nyb2xsRGlzdGFuY2UgPSAoc2Nyb2xsQ29udGFpbmVyLnNjcm9sbExlZnQgKiAxMDApIC8gc2Nyb2xsQ29udGFpbmVyLmNsaWVudFdpZHRoXG4gICAgICAgIHNjcm9sbEJhclRodW1iLnN0eWxlLmxlZnQgPSBgJHsoc2Nyb2xsQmFyVGh1bWJXaWR0aCAvIDEwMCkgKiBjdXJyZW50U2Nyb2xsRGlzdGFuY2UgLSA1fXB4YFxuICAgIH0pO1xuLy8gdHlwZXdyaWdodCB0ZXh0IGFuaW1cbiAgICBmdW5jdGlvbiBkeW5hbWljVHlwZXdyaXRlcihlbGVtZW50LCBzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgdGV4dEFycmF5ID0gZWxlbWVudC50ZXh0Q29udGVudC50cmltKCkuc3BsaXQoJyAnKTtcbiAgICAgICAgY29uc3QgbGl0QXJyID0gdGV4dEFycmF5LmpvaW4oJyAnKS5zcGxpdCgvKFxccyspLykuZmlsdGVyKGZ1bmN0aW9uIChfY2hhcikge1xuICAgICAgICAgICAgcmV0dXJuIF9jaGFyLnRyaW0oKSAhPT0gJycgfHwgX2NoYXIgPT09ICcgJztcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCB3b3JkSW5kZXggPSAwO1xuICAgICAgICBsZXQgY2hhckluZGV4ID0gMDtcbiAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gJyc7XG5cbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX29wYWNpdHlcIilcblxuICAgICAgICBmdW5jdGlvbiB0eXBlV29yZCgpIHtcbiAgICAgICAgICAgIGlmICh3b3JkSW5kZXggPT09IGxpdEFyci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3R5cGV3cml0ZXItY3Vyc29yJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY3VycmVudFdvcmQgPSB0ZXh0QXJyYXlbd29yZEluZGV4XTtcblxuICAgICAgICAgICAgaWYoY3VycmVudFdvcmQgPT09IHVuZGVmaW5lZCkgcmV0dXJuXG5cbiAgICAgICAgICAgIGlmIChjaGFySW5kZXggPCBjdXJyZW50V29yZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VGV4dCArPSBjdXJyZW50V29yZC5jaGFyQXQoY2hhckluZGV4KTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVyVGV4dCA9IGN1cnJlbnRUZXh0O1xuICAgICAgICAgICAgICAgIGNoYXJJbmRleCsrO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQodHlwZVdvcmQsIHNwZWVkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFRleHQgKz0gJyAnO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJUZXh0ID0gY3VycmVudFRleHQ7XG4gICAgICAgICAgICAgICAgY2hhckluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB3b3JkSW5kZXgrKztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHR5cGVXb3JkLCBzcGVlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCd0eXBld3JpdGVyLWN1cnNvcicpO1xuICAgICAgICB0eXBlV29yZCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9ic2VydmVFbGVtZW50cyh0eXBlRWxlbXMpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHJvb3Q6IG51bGwsXG4gICAgICAgICAgICB0aHJlc2hvbGQ6IDAuNVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoZW50cmllcywgb2JzZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnksIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgZHluYW1pY1R5cGV3cml0ZXIoZW50cnkudGFyZ2V0LCAzNSwgKCkgPT4ge30pO1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgb3B0aW9ucyk7XG4gICAgICAgIHR5cGVFbGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHR5cGVBbmltID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnR5cGUtYW5pbScpO1xuICAgIG9ic2VydmVFbGVtZW50cyh0eXBlQW5pbSk7XG5cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGFyay1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+e1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoXCJkYXJrXCIpXG4gICAgfSlcblxuICAgIGxldCBhcnIgPSB7YSA6IDEsIGIgOiAyLCAgYzogMywgZyA6IDR9XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gaW4gYXJyKXtcbiAgICAgICAgY29uc29sZS5sb2coYXJyW2l0ZW1dKVxuICAgIH1cblxufSlcblxuXG5cbiJdfQ==
