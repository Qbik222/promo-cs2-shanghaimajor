"use strict";

document.addEventListener("DOMContentLoaded", function () {
  var stageTabs = document.querySelectorAll(".predict__tabs-item"),
    stageWraps = document.querySelectorAll(".predict__stage"),
    loseCards = document.querySelectorAll(".predict__lose-card"),
    loseCardsTeams = document.querySelectorAll(".predict__lose-team"),
    winCards = document.querySelectorAll(".predict__win-card"),
    winCardsTeams = document.querySelectorAll(".predict__win-team"),
    predictOverlay = document.querySelector(".predict__overlay"),
    predictPopups = predictOverlay.querySelectorAll(".predict__teams"),
    predictTeams = predictOverlay.querySelectorAll(".predict__teams-item"),
    predictBtns = document.querySelectorAll(".cards-btn"),
    predictList = document.querySelectorAll(".predict__list"),
    predictListItem = document.querySelectorAll(".predict__list-item");

  // console.log(predictBtns)

  var currentCard;
  // let setStatus;

  function setPopup(overlay, btns, popups, btnWraps) {
    btns.forEach(function (btn, i) {
      btn.addEventListener("click", function (e) {
        var predictBtns = document.querySelectorAll(".cards-btn"),
          targetClick = true;
        // console.log(predictBtns)
        predictBtns.forEach(function (predictBtn) {
          var storageData = e.target.parentElement.getAttribute("data-storage");
          if (predictBtn === e.target && storageData !== null) {
            targetClick = false;
            e.target.parentElement.removeAttribute("data-storage");
          }
          return targetClick;
        });
        if (targetClick) {
          var index;
          btnWraps.forEach(function (wrap, i) {
            if (btn.parentElement === wrap) {
              return index = i;
            }
          });
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopup(predictOverlay, predictListItem, predictPopups, predictList);
  function showPopup(popups, overlay, index) {
    popups.forEach(function (popup) {
      return popup.classList.remove("_active");
    });
    overlay.classList.add("_active");
    popups[index].classList.add("_active");
    var closeBtn = popups[index].querySelector(".predict__teams-close");
    closeBtn.addEventListener("click", function () {
      overlay.classList.remove("_active");
      popups[index].classList.remove("_active");
    }, {
      once: true
    });
  }
  function setPopupWinLose(overlay, btns, popups, predictBtns) {
    btns.forEach(function (btn, index) {
      btn.addEventListener("click", function (e) {
        var targetClick = true;
        predictBtns.forEach(function (predictBtn) {
          if (predictBtn.classList === e.target.classList) {
            targetClick = false;
          }
          return targetClick;
        });
        if (targetClick) {
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopupWinLose(predictOverlay, winCards, predictPopups, predictBtns);
  setPopupWinLose(predictOverlay, loseCards, predictPopups, predictBtns);
  function setTeam(teams, cardsText, overlay, popups, status) {
    if (status) {
      var cards = [];
      cardsText.forEach(function (item) {
        cards.push(item.parentElement.classList[1]);
      });
      cards.forEach(function (card, i) {
        var key = "selectedTeam-".concat(card, "-").concat(status);
        if (localStorage.getItem(key)) {
          cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
          cardsText[i].parentElement.parentElement.classList.remove("_select");
          if (cardsText[i].innerText.trim() !== '') {
            cardsText[i].parentElement.parentElement.classList.add("_select");
            cardsText[i].parentElement.parentElement.setAttribute('data-storage', key);
          }
        }
      });
      teams.forEach(function (team) {
        team.addEventListener("click", function (e) {
          // const teamParent = team.parentElement.parentElement;
          var teamName = team.querySelector(".team-name").textContent;
          cards.forEach(function (card, i) {
            if (currentCard === cardsText[i].parentElement) {
              var key = "selectedTeam-".concat(card, "-").concat(status);
              currentCard.parentElement.classList.add("_select");
              currentCard.parentElement.setAttribute('data-storage', key);
              localStorage.setItem(key, "".concat(teamName));
              cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
              overlay.classList.remove("_active");
              popups.forEach(function (popup) {
                return popup.classList.remove("_active");
              });
            }
          });
        });
      });
    } else {
      var cardsTextLists = [];
      cardsText.forEach(function (item) {
        return cardsTextLists.push(item);
      });
      cardsTextLists.forEach(function (list, listIndex) {
        list.childNodes.forEach(function (item, i) {
          var stage = list.getAttribute("data-stage"),
            key = "selectedTeam-".concat(stage, "-card").concat(++i),
            teamTextBlock = item.querySelector(".".concat(item.classList[0], "-team"));
          teams.forEach(function (team) {
            team.addEventListener("click", function (e) {
              if (item === currentCard) {
                var teamName = team.querySelector(".team-name").textContent;
                currentCard.classList.add("_select");
                currentCard.setAttribute('data-storage', key);
                localStorage.setItem(key, "".concat(teamName));
                // console.log(item)
                teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
                overlay.classList.remove("_active");
                popups.forEach(function (popup) {
                  return popup.classList.remove("_active");
                });
              }
            });
          });
          if (localStorage.getItem(key)) {
            console.log("key");
            teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
            teamTextBlock.parentElement.parentElement.classList.remove("_select");
            if (teamTextBlock.innerText.trim() !== '') {
              teamTextBlock.parentElement.classList.add("_select");
              teamTextBlock.parentElement.setAttribute('data-storage', key);
            }
          }
        });
      });
    }
  }
  setTeam(predictTeams, winCardsTeams, predictOverlay, predictPopups, "win");
  setTeam(predictTeams, loseCardsTeams, predictOverlay, predictPopups, "lose");
  setTeam(predictTeams, predictList, predictOverlay, predictPopups, null);
  function removeTeam(removeBtns, listState) {
    removeBtns.forEach(function (removeBtn) {
      removeBtn.addEventListener("click", function () {
        var btnParent = removeBtn.parentElement.parentElement,
          dataBtn = btnParent.getAttribute("data-storage");

        // console.log(dataBtn)
        if (!dataBtn) {
          btnParent = removeBtn.parentElement;
          dataBtn = btnParent.getAttribute("data-storage");
        }
        localStorage.removeItem(dataBtn);
        btnParent.classList.remove("_select");
      });
    });
  }

  // removeTeam(predictBtns)
  removeTeam(predictBtns);
  stageTabs.forEach(function (tab, tabIndex) {
    tab.addEventListener("click", function (e) {
      stageTabs.forEach(function (tab, i) {
        tab.classList.remove("_active");
      });
      stageWraps.forEach(function (item, stageIndex) {
        item.classList.remove("_active");
        if (tabIndex === stageIndex) {
          item.classList.add("_active");
          if (item.classList.contains("stage3")) {
            item.parentElement.classList.add('stage3');
          } else {
            item.parentElement.classList.remove('stage3');
          }
        }
      });
      e.target.classList.add("_active");
    });
  });

  // countdown timer
  function startCountdown(element) {
    var targetDate = new Date(element.getAttribute('data-target-date'));
    function updateCountdown() {
      var now = new Date(),
        difference = targetDate - now;
      if (difference <= 0) {
        element.querySelector('.predict__info-lock-countdown').textContent = "time over";
        clearInterval(countdownInterval);
        return;
      }
      var days = Math.floor(difference / (1000 * 60 * 60 * 24)),
        hours = Math.floor(difference % (1000 * 60 * 60 * 24) / (1000 * 60 * 60)),
        minutes = Math.floor(difference % (1000 * 60 * 60) / (1000 * 60));
      element.querySelector('.predict__info-lock-days').textContent = days;
      element.querySelector('.predict__info-lock-hours').textContent = hours;
      element.querySelector('.predict__info-lock-minutes').textContent = minutes;
    }
    var countdownInterval = setInterval(updateCountdown, 60000);
    updateCountdown();
  }
  document.querySelectorAll('.predict__info-lock-countdown').forEach(startCountdown);

  // custom horizontal scroll
  var scrollBar = document.querySelector(".table__scrollbar"),
    scrollBarThumb = document.querySelector(".table__scrollbar-thumb"),
    scrollElem = document.querySelector('.table__wrap-scroll'),
    scrollContainer = document.querySelector('.table__wrap');
  var scrollBarWidth = scrollContainer.clientWidth - 50,
    scrollBarThumbWidth;
  if (scrollElem.clientWidth <= scrollContainer.clientWidth) {
    scrollBar.style.display = "none";
  } else {
    scrollBar.style.display = "block";
    scrollBarThumbWidth = (scrollBarWidth * scrollContainer.clientWidth - 50) / scrollElem.scrollWidth;
    scrollBarThumb.style.width = "".concat(scrollBarThumbWidth, "px");
    scrollBar.style.width = "".concat(scrollBarWidth, "px");
  }
  var currentScrollDistance = 0;
  scrollContainer.addEventListener("scroll", function () {
    currentScrollDistance = scrollContainer.scrollLeft * 100 / scrollContainer.clientWidth;
    scrollBarThumb.style.left = "".concat(scrollBarThumbWidth / 100 * currentScrollDistance, "px");
  });

  // scroll anim
  function isInViewport(element, visibilityThreshold) {
    var rect = element.getBoundingClientRect(),
      windowHeight = window.innerHeight || document.documentElement.clientHeight,
      windowWidth = window.innerWidth || document.documentElement.clientWidth,
      visibleHeight = Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0),
      visibleWidth = Math.min(rect.right, windowWidth) - Math.max(rect.left, 0),
      elementHeight = rect.height,
      elementWidth = rect.width,
      visibleArea = visibleHeight * visibleWidth,
      totalArea = elementHeight * elementWidth,
      visiblePercentage = visibleArea / totalArea;
    return visiblePercentage >= visibilityThreshold;
  }
  function addClassOnVisibility(element, className, visibilityThreshold) {
    window.addEventListener('scroll', function () {
      if (isInViewport(element, visibilityThreshold)) {
        element.classList.add(className);
      }
    });
    document.addEventListener("DOMContentLoaded", function () {
      if (isInViewport(element, visibilityThreshold)) {
        element.classList.add(className);
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhZ2VUYWJzIiwicXVlcnlTZWxlY3RvckFsbCIsInN0YWdlV3JhcHMiLCJsb3NlQ2FyZHMiLCJsb3NlQ2FyZHNUZWFtcyIsIndpbkNhcmRzIiwid2luQ2FyZHNUZWFtcyIsInByZWRpY3RPdmVybGF5IiwicXVlcnlTZWxlY3RvciIsInByZWRpY3RQb3B1cHMiLCJwcmVkaWN0VGVhbXMiLCJwcmVkaWN0QnRucyIsInByZWRpY3RMaXN0IiwicHJlZGljdExpc3RJdGVtIiwiY3VycmVudENhcmQiLCJzZXRQb3B1cCIsIm92ZXJsYXkiLCJidG5zIiwicG9wdXBzIiwiYnRuV3JhcHMiLCJmb3JFYWNoIiwiYnRuIiwiaSIsImUiLCJ0YXJnZXRDbGljayIsInByZWRpY3RCdG4iLCJzdG9yYWdlRGF0YSIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbmRleCIsIndyYXAiLCJzaG93UG9wdXAiLCJwb3B1cCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsImNsb3NlQnRuIiwib25jZSIsInNldFBvcHVwV2luTG9zZSIsInNldFRlYW0iLCJ0ZWFtcyIsImNhcmRzVGV4dCIsInN0YXR1cyIsImNhcmRzIiwiaXRlbSIsInB1c2giLCJjYXJkIiwia2V5IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImlubmVySFRNTCIsImlubmVyVGV4dCIsInRyaW0iLCJzZXRBdHRyaWJ1dGUiLCJ0ZWFtIiwidGVhbU5hbWUiLCJ0ZXh0Q29udGVudCIsInNldEl0ZW0iLCJjYXJkc1RleHRMaXN0cyIsImxpc3QiLCJsaXN0SW5kZXgiLCJjaGlsZE5vZGVzIiwic3RhZ2UiLCJ0ZWFtVGV4dEJsb2NrIiwiY29uc29sZSIsImxvZyIsInJlbW92ZVRlYW0iLCJyZW1vdmVCdG5zIiwibGlzdFN0YXRlIiwicmVtb3ZlQnRuIiwiYnRuUGFyZW50IiwiZGF0YUJ0biIsInJlbW92ZUl0ZW0iLCJ0YWIiLCJ0YWJJbmRleCIsInN0YWdlSW5kZXgiLCJjb250YWlucyIsInN0YXJ0Q291bnRkb3duIiwiZWxlbWVudCIsInRhcmdldERhdGUiLCJEYXRlIiwidXBkYXRlQ291bnRkb3duIiwibm93IiwiZGlmZmVyZW5jZSIsImNsZWFySW50ZXJ2YWwiLCJjb3VudGRvd25JbnRlcnZhbCIsImRheXMiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZXRJbnRlcnZhbCIsInNjcm9sbEJhciIsInNjcm9sbEJhclRodW1iIiwic2Nyb2xsRWxlbSIsInNjcm9sbENvbnRhaW5lciIsInNjcm9sbEJhcldpZHRoIiwiY2xpZW50V2lkdGgiLCJzY3JvbGxCYXJUaHVtYldpZHRoIiwic3R5bGUiLCJkaXNwbGF5Iiwic2Nyb2xsV2lkdGgiLCJ3aWR0aCIsImN1cnJlbnRTY3JvbGxEaXN0YW5jZSIsInNjcm9sbExlZnQiLCJsZWZ0IiwiaXNJblZpZXdwb3J0IiwidmlzaWJpbGl0eVRocmVzaG9sZCIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aW5kb3dIZWlnaHQiLCJ3aW5kb3ciLCJpbm5lckhlaWdodCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsIndpbmRvd1dpZHRoIiwiaW5uZXJXaWR0aCIsInZpc2libGVIZWlnaHQiLCJtaW4iLCJib3R0b20iLCJtYXgiLCJ0b3AiLCJ2aXNpYmxlV2lkdGgiLCJyaWdodCIsImVsZW1lbnRIZWlnaHQiLCJoZWlnaHQiLCJlbGVtZW50V2lkdGgiLCJ2aXNpYmxlQXJlYSIsInRvdGFsQXJlYSIsInZpc2libGVQZXJjZW50YWdlIiwiYWRkQ2xhc3NPblZpc2liaWxpdHkiLCJjbGFzc05hbWUiXSwibWFwcGluZ3MiOiI7O0FBQUFBLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsWUFBSTtFQUM5QyxJQUFNQyxTQUFTLEdBQUdGLFFBQVEsQ0FBQ0csZ0JBQWdCLENBQUMs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QixJQUFJLENBQUNOLEtBQUs7TUFDekJ5QixXQUFXLEdBQUdWLGFBQWEsR0FBR0ssWUFBWTtNQUMxQ00sU0FBUyxHQUFHSixhQUFhLEdBQUdFLFlBQVk7TUFDeENHLGlCQUFpQixHQUFHRixXQUFXLEdBQUdDLFNBQVM7SUFDakQsT0FBT0MsaUJBQWlCLElBQUl0QixtQkFBbUI7RUFDbkQ7RUFDQSxTQUFTdUIsb0JBQW9CLENBQUNwRCxPQUFPLEVBQUVxRCxTQUFTLEVBQUV4QixtQkFBbUIsRUFBRTtJQUNuRUksTUFBTSxDQUFDbEgsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLFlBQU07TUFDcEMsSUFBSTZHLFlBQVksQ0FBQzVCLE9BQU8sRUFBRTZCLG1CQUFtQixDQUFDLEVBQUU7UUFDNUM3QixPQUFPLENBQUM3QyxTQUFTLENBQUNFLEdBQUcsQ0FBQ2dHLFNBQVMsQ0FBQztNQUNwQztJQUNKLENBQUMsQ0FBQztJQUNGdkksUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxZQUFNO01BQ2hELElBQUk2RyxZQUFZLENBQUM1QixPQUFPLEVBQUU2QixtQkFBbUIsQ0FBQyxFQUFFO1FBQzVDN0IsT0FBTyxDQUFDN0MsU0FBUyxDQUFDRSxHQUFHLENBQUNnRyxTQUFTLENBQUM7TUFDcEM7SUFDSixDQUFDLENBQUM7RUFDTjtBQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCk9PntcbiAgICBjb25zdCBzdGFnZVRhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3RhYnMtaXRlbVwiKSxcbiAgICAgICAgICBzdGFnZVdyYXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X19zdGFnZVwiKSxcbiAgICAgICAgICBsb3NlQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX2xvc2UtY2FyZFwiKSxcbiAgICAgICAgICBsb3NlQ2FyZHNUZWFtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbG9zZS10ZWFtXCIpLFxuICAgICAgICAgIHdpbkNhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X193aW4tY2FyZFwiKSxcbiAgICAgICAgICB3aW5DYXJkc1RlYW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X193aW4tdGVhbVwiKSxcbiAgICAgICAgICBwcmVkaWN0T3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJlZGljdF9fb3ZlcmxheVwiKSxcbiAgICAgICAgICBwcmVkaWN0UG9wdXBzID0gcHJlZGljdE92ZXJsYXkucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X190ZWFtc1wiKSxcbiAgICAgICAgICBwcmVkaWN0VGVhbXMgPSBwcmVkaWN0T3ZlcmxheS5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3RlYW1zLWl0ZW1cIiksXG4gICAgICAgICAgcHJlZGljdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRzLWJ0blwiKSxcbiAgICAgICAgICBwcmVkaWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbGlzdFwiKSxcbiAgICAgICAgICBwcmVkaWN0TGlzdEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX2xpc3QtaXRlbVwiKVxuXG4gICAgLy8gY29uc29sZS5sb2cocHJlZGljdEJ0bnMpXG5cbiAgICBsZXQgY3VycmVudENhcmQ7XG4gICAgLy8gbGV0IHNldFN0YXR1cztcblxuXG4gICAgZnVuY3Rpb24gc2V0UG9wdXAob3ZlcmxheSwgYnRucywgcG9wdXBzLCAgYnRuV3JhcHMpIHtcbiAgICAgICAgYnRucy5mb3JFYWNoKChidG4sIGkpID0+IHtcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcHJlZGljdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRzLWJ0blwiKSxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2xpY2sgPSB0cnVlXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJlZGljdEJ0bnMpXG4gICAgICAgICAgICAgICAgcHJlZGljdEJ0bnMuZm9yRWFjaChwcmVkaWN0QnRuID0+e1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcmFnZURhdGEgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuICAgICAgICAgICAgICAgICAgICBpZihwcmVkaWN0QnRuID09PSBlLnRhcmdldCAmJiBzdG9yYWdlRGF0YSAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGljayA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRDbGlja1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYodGFyZ2V0Q2xpY2spe1xuICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGJ0bldyYXBzLmZvckVhY2goKHdyYXAsIGkpID0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnRuLnBhcmVudEVsZW1lbnQgPT09IHdyYXApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmRleCA9IGlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgc2hvd1BvcHVwKHBvcHVwcywgb3ZlcmxheSwgaW5kZXgpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Q2FyZCA9IGJ0blxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXRQb3B1cChwcmVkaWN0T3ZlcmxheSwgcHJlZGljdExpc3RJdGVtLCBwcmVkaWN0UG9wdXBzLCBwcmVkaWN0TGlzdClcblxuXG4gICAgZnVuY3Rpb24gc2hvd1BvcHVwKHBvcHVwcywgb3ZlcmxheSwgaW5kZXgpe1xuICAgICAgICBwb3B1cHMuZm9yRWFjaChwb3B1cCA9PiBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKSk7XG4gICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIik7XG4gICAgICAgIHBvcHVwc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIik7XG4gICAgICAgIGNvbnN0IGNsb3NlQnRuID0gcG9wdXBzW2luZGV4XS5xdWVyeVNlbGVjdG9yKFwiLnByZWRpY3RfX3RlYW1zLWNsb3NlXCIpO1xuICAgICAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgIHBvcHVwc1tpbmRleF0uY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIik7XG4gICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRQb3B1cFdpbkxvc2Uob3ZlcmxheSwgYnRucywgcG9wdXBzLCBwcmVkaWN0QnRucykge1xuICAgICAgICBidG5zLmZvckVhY2goKGJ0biwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0Q2xpY2sgPSB0cnVlXG4gICAgICAgICAgICAgICAgcHJlZGljdEJ0bnMuZm9yRWFjaChwcmVkaWN0QnRuID0+e1xuICAgICAgICAgICAgICAgICAgICBpZihwcmVkaWN0QnRuLmNsYXNzTGlzdCA9PT0gZS50YXJnZXQuY2xhc3NMaXN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldENsaWNrID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0Q2xpY2tcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGlmKHRhcmdldENsaWNrKXtcbiAgICAgICAgICAgICAgICAgICAgc2hvd1BvcHVwKHBvcHVwcywgb3ZlcmxheSwgaW5kZXgpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Q2FyZCA9IGJ0blxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0UG9wdXBXaW5Mb3NlKHByZWRpY3RPdmVybGF5LCB3aW5DYXJkcywgcHJlZGljdFBvcHVwcywgcHJlZGljdEJ0bnMpXG4gICAgc2V0UG9wdXBXaW5Mb3NlKHByZWRpY3RPdmVybGF5LCBsb3NlQ2FyZHMsIHByZWRpY3RQb3B1cHMsIHByZWRpY3RCdG5zKVxuXG5cblxuICAgIGZ1bmN0aW9uIHNldFRlYW0odGVhbXMsIGNhcmRzVGV4dCwgb3ZlcmxheSwgcG9wdXBzLCBzdGF0dXMpIHtcbiAgICAgICAgaWYoc3RhdHVzKXtcbiAgICAgICAgICAgIGxldCBjYXJkcyA9IFtdO1xuICAgICAgICAgICAgY2FyZHNUZXh0LmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZHMucHVzaChpdGVtLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0WzFdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FyZHMuZm9yRWFjaCgoY2FyZCwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBrZXkgPSBgc2VsZWN0ZWRUZWFtLSR7Y2FyZH0tJHtzdGF0dXN9YDtcbiAgICAgICAgICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHNUZXh0W2ldLmlubmVySFRNTCA9IGDQmtC+0LzQsNC90LTQsCA8YnI+ICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KX1gO1xuICAgICAgICAgICAgICAgICAgICBjYXJkc1RleHRbaV0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgIGlmKGNhcmRzVGV4dFtpXS5pbm5lclRleHQudHJpbSgpICE9PSAnJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkc1RleHRbaV0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkc1RleHRbaV0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yYWdlJywga2V5KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRlYW1zLmZvckVhY2goKHRlYW0pID0+IHtcbiAgICAgICAgICAgICAgICB0ZWFtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCB0ZWFtUGFyZW50ID0gdGVhbS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlYW1OYW1lID0gdGVhbS5xdWVyeVNlbGVjdG9yKFwiLnRlYW0tbmFtZVwiKS50ZXh0Q29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgY2FyZHMuZm9yRWFjaCgoY2FyZCwgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDYXJkID09PSBjYXJkc1RleHRbaV0ucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSBgc2VsZWN0ZWRUZWFtLSR7Y2FyZH0tJHtzdGF0dXN9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2FyZC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENhcmQucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcmFnZScsIGtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGAke3RlYW1OYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzVGV4dFtpXS5pbm5lckhUTUwgPSBg0JrQvtC80LDQvdC00LAgPGJyPiAke3RlYW1OYW1lfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cHMuZm9yRWFjaChwb3B1cCA9PiBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGxldCBjYXJkc1RleHRMaXN0cyA9IFtdXG4gICAgICAgICAgICBjYXJkc1RleHQuZm9yRWFjaChpdGVtID0+e1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkc1RleHRMaXN0cy5wdXNoKGl0ZW0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY2FyZHNUZXh0TGlzdHMuZm9yRWFjaCgobGlzdCwgbGlzdEluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgbGlzdC5jaGlsZE5vZGVzLmZvckVhY2goKGl0ZW0sIGkpID0+e1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RhZ2UgPSBsaXN0LmdldEF0dHJpYnV0ZShcImRhdGEtc3RhZ2VcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBgc2VsZWN0ZWRUZWFtLSR7c3RhZ2V9LWNhcmQkeysraX1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jayA9IGl0ZW0ucXVlcnlTZWxlY3RvcihgLiR7aXRlbS5jbGFzc0xpc3RbMF19LXRlYW1gKVxuICAgICAgICAgICAgICAgICAgICB0ZWFtcy5mb3JFYWNoKCh0ZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZWFtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0gPT09IGN1cnJlbnRDYXJkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVhbU5hbWUgPSB0ZWFtLnF1ZXJ5U2VsZWN0b3IoXCIudGVhbS1uYW1lXCIpLnRleHRDb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkLmNsYXNzTGlzdC5hZGQoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkLnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yYWdlJywga2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGAke3RlYW1OYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpdGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZWFtVGV4dEJsb2NrLmlubmVySFRNTCA9IGDQmtC+0LzQsNC90LTQsCA8YnI+ICR7dGVhbU5hbWV9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBzLmZvckVhY2gocG9wdXAgPT4gcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIikpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwia2V5XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZWFtVGV4dEJsb2NrLmlubmVySFRNTCA9IGDQmtC+0LzQsNC90LTQsCA8YnI+ICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jay5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlYW1UZXh0QmxvY2suaW5uZXJUZXh0LnRyaW0oKSAhPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2sucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2sucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcmFnZScsIGtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBzZXRUZWFtKHByZWRpY3RUZWFtcywgd2luQ2FyZHNUZWFtcywgcHJlZGljdE92ZXJsYXksIHByZWRpY3RQb3B1cHMsIFwid2luXCIpO1xuICAgIHNldFRlYW0ocHJlZGljdFRlYW1zLCBsb3NlQ2FyZHNUZWFtcywgcHJlZGljdE92ZXJsYXksIHByZWRpY3RQb3B1cHMsIFwibG9zZVwiKTtcbiAgICBzZXRUZWFtKHByZWRpY3RUZWFtcywgcHJlZGljdExpc3QsIHByZWRpY3RPdmVybGF5LCBwcmVkaWN0UG9wdXBzLCBudWxsKTtcblxuICAgIGZ1bmN0aW9uIHJlbW92ZVRlYW0ocmVtb3ZlQnRucywgbGlzdFN0YXRlKXtcbiAgICAgICAgcmVtb3ZlQnRucy5mb3JFYWNoKHJlbW92ZUJ0biA9PntcbiAgICAgICAgICAgIHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgICAgICAgICAgICAgbGV0IGJ0blBhcmVudCA9ICByZW1vdmVCdG4ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICBkYXRhQnRuID0gYnRuUGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YUJ0bilcbiAgICAgICAgICAgICAgICBpZighZGF0YUJ0bil7XG4gICAgICAgICAgICAgICAgICAgIGJ0blBhcmVudCA9IHJlbW92ZUJ0bi5wYXJlbnRFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIGRhdGFCdG4gPSBidG5QYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zdG9yYWdlXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGRhdGFCdG4pXG4gICAgICAgICAgICAgICAgYnRuUGFyZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlVGVhbShwcmVkaWN0QnRucylcbiAgICByZW1vdmVUZWFtKHByZWRpY3RCdG5zKVxuXG4gICAgc3RhZ2VUYWJzLmZvckVhY2goKHRhYiwgdGFiSW5kZXgpID0+e1xuICAgICAgICB0YWIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PntcbiAgICAgICAgICAgIHN0YWdlVGFicy5mb3JFYWNoKCh0YWIsIGkpID0+e1xuICAgICAgICAgICAgICB0YWIuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBzdGFnZVdyYXBzLmZvckVhY2goKGl0ZW0sIHN0YWdlSW5kZXgpID0+e1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIilcbiAgICAgICAgICAgICAgICBpZih0YWJJbmRleCA9PT0gc3RhZ2VJbmRleCl7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIilcbiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJzdGFnZTNcIikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3N0YWdlMycpXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3N0YWdlMycpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIilcbiAgICAgICAgfSlcbiAgICB9KVxuXG4vLyBjb3VudGRvd24gdGltZXJcbiAgICBmdW5jdGlvbiBzdGFydENvdW50ZG93bihlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHRhcmdldERhdGUgPSBuZXcgRGF0ZShlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQtZGF0ZScpKVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDb3VudGRvd24oKSB7XG4gICAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRhcmdldERhdGUgLSBub3dcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlIDw9IDApIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVkaWN0X19pbmZvLWxvY2stY291bnRkb3duJykudGV4dENvbnRlbnQgPSBcInRpbWUgb3ZlclwiXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjb3VudGRvd25JbnRlcnZhbClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRheXMgPSBNYXRoLmZsb29yKGRpZmZlcmVuY2UgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpLFxuICAgICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLmZsb29yKChkaWZmZXJlbmNlICUgKDEwMDAgKiA2MCAqIDYwICogMjQpKSAvICgxMDAwICogNjAgKiA2MCkpLFxuICAgICAgICAgICAgICAgICAgbWludXRlcyA9IE1hdGguZmxvb3IoKGRpZmZlcmVuY2UgJSAoMTAwMCAqIDYwICogNjApKSAvICgxMDAwICogNjApKVxuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucHJlZGljdF9faW5mby1sb2NrLWRheXMnKS50ZXh0Q29udGVudCA9IGRheXNcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZWRpY3RfX2luZm8tbG9jay1ob3VycycpLnRleHRDb250ZW50ID0gaG91cnNcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZWRpY3RfX2luZm8tbG9jay1taW51dGVzJykudGV4dENvbnRlbnQgPSBtaW51dGVzXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY291bnRkb3duSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh1cGRhdGVDb3VudGRvd24sIDYwMDAwKVxuICAgICAgICB1cGRhdGVDb3VudGRvd24oKVxuICAgIH1cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJlZGljdF9faW5mby1sb2NrLWNvdW50ZG93bicpLmZvckVhY2goc3RhcnRDb3VudGRvd24pXG5cbiAgICAvLyBjdXN0b20gaG9yaXpvbnRhbCBzY3JvbGxcbiAgICBjb25zdCBzY3JvbGxCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19zY3JvbGxiYXJcIiksXG4gICAgICAgICAgc2Nyb2xsQmFyVGh1bWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19zY3JvbGxiYXItdGh1bWJcIiksXG4gICAgICAgICAgc2Nyb2xsRWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJsZV9fd3JhcC1zY3JvbGwnKSxcbiAgICAgICAgICBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFibGVfX3dyYXAnKVxuXG4gICAgbGV0IHNjcm9sbEJhcldpZHRoID0gc2Nyb2xsQ29udGFpbmVyLmNsaWVudFdpZHRoIC0gNTAsXG4gICAgICAgIHNjcm9sbEJhclRodW1iV2lkdGg7XG5cbiAgICBpZiAoc2Nyb2xsRWxlbS5jbGllbnRXaWR0aCA8PSBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGgpIHtcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgIH0gZWxzZSB7XG4gICAgICAgIHNjcm9sbEJhci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiXG4gICAgICAgIHNjcm9sbEJhclRodW1iV2lkdGggPSAoc2Nyb2xsQmFyV2lkdGggKiBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGggLSA1MCkgLyBzY3JvbGxFbGVtLnNjcm9sbFdpZHRoXG4gICAgICAgIHNjcm9sbEJhclRodW1iLnN0eWxlLndpZHRoID0gYCR7c2Nyb2xsQmFyVGh1bWJXaWR0aH1weGBcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLndpZHRoID0gYCR7c2Nyb2xsQmFyV2lkdGh9cHhgXG4gICAgfVxuXG4gICAgbGV0IGN1cnJlbnRTY3JvbGxEaXN0YW5jZSA9IDBcblxuICAgIHNjcm9sbENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsICgpID0+IHtcbiAgICAgICAgY3VycmVudFNjcm9sbERpc3RhbmNlID0gKHNjcm9sbENvbnRhaW5lci5zY3JvbGxMZWZ0ICogMTAwKSAvIHNjcm9sbENvbnRhaW5lci5jbGllbnRXaWR0aFxuICAgICAgICBzY3JvbGxCYXJUaHVtYi5zdHlsZS5sZWZ0ID0gYCR7KHNjcm9sbEJhclRodW1iV2lkdGggLyAxMDApICogY3VycmVudFNjcm9sbERpc3RhbmNlfXB4YFxuICAgIH0pO1xuXG4vLyBzY3JvbGwgYW5pbVxuICAgIGZ1bmN0aW9uIGlzSW5WaWV3cG9ydChlbGVtZW50LCB2aXNpYmlsaXR5VGhyZXNob2xkKSB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCxcbiAgICAgICAgICAgICAgd2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgIHZpc2libGVIZWlnaHQgPSBNYXRoLm1pbihyZWN0LmJvdHRvbSwgd2luZG93SGVpZ2h0KSAtIE1hdGgubWF4KHJlY3QudG9wLCAwKSxcbiAgICAgICAgICAgICAgdmlzaWJsZVdpZHRoID0gTWF0aC5taW4ocmVjdC5yaWdodCwgd2luZG93V2lkdGgpIC0gTWF0aC5tYXgocmVjdC5sZWZ0LCAwKSxcbiAgICAgICAgICAgICAgZWxlbWVudEhlaWdodCA9IHJlY3QuaGVpZ2h0LFxuICAgICAgICAgICAgICBlbGVtZW50V2lkdGggPSByZWN0LndpZHRoLFxuICAgICAgICAgICAgICB2aXNpYmxlQXJlYSA9IHZpc2libGVIZWlnaHQgKiB2aXNpYmxlV2lkdGgsXG4gICAgICAgICAgICAgIHRvdGFsQXJlYSA9IGVsZW1lbnRIZWlnaHQgKiBlbGVtZW50V2lkdGgsXG4gICAgICAgICAgICAgIHZpc2libGVQZXJjZW50YWdlID0gdmlzaWJsZUFyZWEgLyB0b3RhbEFyZWFcbiAgICAgICAgcmV0dXJuIHZpc2libGVQZXJjZW50YWdlID49IHZpc2liaWxpdHlUaHJlc2hvbGRcbiAgICB9XG4gICAgZnVuY3Rpb24gYWRkQ2xhc3NPblZpc2liaWxpdHkoZWxlbWVudCwgY2xhc3NOYW1lLCB2aXNpYmlsaXR5VGhyZXNob2xkKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoaXNJblZpZXdwb3J0KGVsZW1lbnQsIHZpc2liaWxpdHlUaHJlc2hvbGQpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmIChpc0luVmlld3BvcnQoZWxlbWVudCwgdmlzaWJpbGl0eVRocmVzaG9sZCkpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn0pXG5cblxuXG4iXX0=
