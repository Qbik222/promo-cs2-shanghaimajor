"use strict";

document.addEventListener("DOMContentLoaded", function () {
  var stageTabs = document.querySelectorAll(".predict__tabs-item"),
    stageWraps = document.querySelectorAll(".predict__stage"),
    loseCards = document.querySelectorAll(".predict__lose-card"),
    loseCardsTeams = document.querySelectorAll(".predict__lose-team"),
    winCards = document.querySelectorAll(".predict__win-card"),
    winCardsTeams = document.querySelectorAll(".predict__win-team"),
    predictOverlay = document.querySelector(".predict__overlay"),
    predictPopups = predictOverlay.querySelectorAll(".predict__teams"),
    predictTeams = predictOverlay.querySelectorAll(".predict__teams-item"),
    predictBtns = document.querySelectorAll(".cards-btn"),
    predictList = document.querySelectorAll(".predict__list"),
    predictListItem = document.querySelectorAll(".predict__list-item");

  // console.log(predictBtns)

  var currentCard;
  // let setStatus;

  function setPopup(overlay, btns, popups, btnWraps) {
    btns.forEach(function (btn, i) {
      btn.addEventListener("click", function (e) {
        var predictBtns = document.querySelectorAll(".cards-btn"),
          targetClick = true;
        // console.log(predictBtns)
        predictBtns.forEach(function (predictBtn) {
          var storageData = e.target.parentElement.getAttribute("data-storage");
          if (predictBtn === e.target && storageData !== null) {
            targetClick = false;
            e.target.parentElement.removeAttribute("data-storage");
          }
          return targetClick;
        });
        if (targetClick) {
          var index;
          btnWraps.forEach(function (wrap, i) {
            if (btn.parentElement === wrap) {
              return index = i;
            }
          });
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopup(predictOverlay, predictListItem, predictPopups, predictList);
  function showPopup(popups, overlay, index) {
    popups.forEach(function (popup) {
      return popup.classList.remove("_active");
    });
    overlay.classList.add("_active");
    popups[index].classList.add("_active");
    document.body.style.overflow = "hidden";
    var closeBtn = popups[index].querySelector(".predict__teams-close");
    closeBtn.addEventListener("click", function () {
      overlay.classList.remove("_active");
      popups[index].classList.remove("_active");
      document.body.style.overflow = "auto";
    }, {
      once: true
    });
  }
  function setPopupWinLose(overlay, btns, popups, predictBtns) {
    btns.forEach(function (btn, index) {
      btn.addEventListener("click", function (e) {
        var targetClick = true;
        predictBtns.forEach(function (predictBtn) {
          if (predictBtn.classList === e.target.classList) {
            targetClick = false;
          }
          return targetClick;
        });
        if (targetClick) {
          showPopup(popups, overlay, index);
          return currentCard = btn;
        }
      });
    });
  }
  setPopupWinLose(predictOverlay, winCards, predictPopups, predictBtns);
  setPopupWinLose(predictOverlay, loseCards, predictPopups, predictBtns);
  function setTeam(teams, cardsText, overlay, popups, status) {
    if (status) {
      var cards = [];
      cardsText.forEach(function (item) {
        cards.push(item.parentElement.classList[1]);
      });
      cards.forEach(function (card, i) {
        var key = "selectedTeam-".concat(card, "-").concat(status);
        if (localStorage.getItem(key)) {
          cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
          cardsText[i].parentElement.parentElement.classList.remove("_select");
          if (cardsText[i].innerText.trim() !== '') {
            cardsText[i].parentElement.parentElement.classList.add("_select");
            cardsText[i].parentElement.parentElement.setAttribute('data-storage', key);
          }
        }
      });
      teams.forEach(function (team) {
        team.addEventListener("click", function (e) {
          // const teamParent = team.parentElement.parentElement;
          var teamName = team.querySelector(".team-name").textContent;
          cards.forEach(function (card, i) {
            if (currentCard === cardsText[i].parentElement) {
              var key = "selectedTeam-".concat(card, "-").concat(status);
              currentCard.parentElement.classList.add("_select");
              currentCard.parentElement.setAttribute('data-storage', key);
              localStorage.setItem(key, "".concat(teamName));
              cardsText[i].innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
              overlay.classList.remove("_active");
              popups.forEach(function (popup) {
                return popup.classList.remove("_active");
              });
              document.body.style.overflow = "auto";
            }
          });
        });
      });
    } else {
      var cardsTextLists = [];
      cardsText.forEach(function (item) {
        return cardsTextLists.push(item);
      });
      cardsTextLists.forEach(function (list, listIndex) {
        list.childNodes.forEach(function (item, i) {
          var stage = list.getAttribute("data-stage"),
            key = "selectedTeam-".concat(stage, "-card").concat(++i),
            teamTextBlock = item.querySelector(".".concat(item.classList[0], "-team"));
          teams.forEach(function (team) {
            team.addEventListener("click", function (e) {
              if (item === currentCard) {
                var teamName = team.querySelector(".team-name").textContent;
                currentCard.classList.add("_select");
                currentCard.setAttribute('data-storage', key);
                localStorage.setItem(key, "".concat(teamName));
                // console.log(item)
                teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(teamName);
                overlay.classList.remove("_active");
                popups.forEach(function (popup) {
                  return popup.classList.remove("_active");
                });
                document.body.style.overflow = "auto";
              }
            });
          });
          if (localStorage.getItem(key)) {
            console.log("key");
            teamTextBlock.innerHTML = "\u041A\u043E\u043C\u0430\u043D\u0434\u0430 <br> ".concat(localStorage.getItem(key));
            teamTextBlock.parentElement.parentElement.classList.remove("_select");
            if (teamTextBlock.innerText.trim() !== '') {
              teamTextBlock.parentElement.classList.add("_select");
              teamTextBlock.parentElement.setAttribute('data-storage', key);
            }
          }
        });
      });
    }
  }
  setTeam(predictTeams, winCardsTeams, predictOverlay, predictPopups, "win");
  setTeam(predictTeams, loseCardsTeams, predictOverlay, predictPopups, "lose");
  setTeam(predictTeams, predictList, predictOverlay, predictPopups, null);
  function removeTeam(removeBtns, listState) {
    removeBtns.forEach(function (removeBtn) {
      removeBtn.addEventListener("click", function () {
        var btnParent = removeBtn.parentElement.parentElement,
          dataBtn = btnParent.getAttribute("data-storage");

        // console.log(dataBtn)
        if (!dataBtn) {
          btnParent = removeBtn.parentElement;
          dataBtn = btnParent.getAttribute("data-storage");
        }
        localStorage.removeItem(dataBtn);
        btnParent.classList.remove("_select");
      });
    });
  }

  // removeTeam(predictBtns)
  removeTeam(predictBtns);
  stageTabs.forEach(function (tab, tabIndex) {
    tab.addEventListener("click", function (e) {
      stageTabs.forEach(function (tab, i) {
        tab.classList.remove("_active");
      });
      stageWraps.forEach(function (item, stageIndex) {
        item.classList.remove("_active");
        if (tabIndex === stageIndex) {
          item.classList.add("_active");
          if (item.classList.contains("stage3")) {
            item.parentElement.classList.add('stage3');
          } else {
            item.parentElement.classList.remove('stage3');
          }
        }
      });
      e.target.classList.add("_active");
    });
  });

  // countdown timer
  function startCountdown(element) {
    var targetDate = new Date(element.getAttribute('data-target-date'));
    function updateCountdown() {
      var now = new Date(),
        difference = targetDate - now;
      if (difference <= 0) {
        element.querySelector('.predict__info-lock-countdown').textContent = "time over";
        clearInterval(countdownInterval);
        return;
      }
      var days = Math.floor(difference / (1000 * 60 * 60 * 24)),
        hours = Math.floor(difference % (1000 * 60 * 60 * 24) / (1000 * 60 * 60)),
        minutes = Math.floor(difference % (1000 * 60 * 60) / (1000 * 60));
      element.querySelector('.predict__info-lock-days').textContent = days;
      element.querySelector('.predict__info-lock-hours').textContent = hours;
      element.querySelector('.predict__info-lock-minutes').textContent = minutes;
    }
    var countdownInterval = setInterval(updateCountdown, 60000);
    updateCountdown();
  }
  document.querySelectorAll('.predict__info-lock-countdown').forEach(startCountdown);

  // custom horizontal scroll
  var scrollBar = document.querySelector(".table__scrollbar"),
    scrollBarThumb = document.querySelector(".table__scrollbar-thumb"),
    scrollElem = document.querySelector('.table__wrap-scroll'),
    scrollContainer = document.querySelector('.table__wrap');
  var scrollBarWidth = scrollContainer.clientWidth - 50,
    scrollBarThumbWidth;
  if (scrollElem.clientWidth <= scrollContainer.clientWidth) {
    scrollBar.style.display = "none";
  } else {
    scrollBar.style.display = "block";
    scrollBarThumbWidth = (scrollBarWidth * scrollContainer.clientWidth - 50) / scrollElem.scrollWidth;
    scrollBarThumb.style.width = "".concat(scrollBarThumbWidth, "px");
    scrollBar.style.width = "".concat(scrollBarWidth, "px");
  }
  var currentScrollDistance = 0;
  scrollContainer.addEventListener("scroll", function () {
    currentScrollDistance = scrollContainer.scrollLeft * 100 / scrollContainer.clientWidth;
    scrollBarThumb.style.left = "".concat(scrollBarThumbWidth / 100 * currentScrollDistance - 5, "px");
  });
  // typewright text anim
  function dynamicTypewriter(element, speed, callback) {
    var textArray = element.textContent.trim().split(' ');
    var litArr = textArray.join(' ').split(/(\s+)/).filter(function (_char) {
      return _char.trim() !== '' || _char === ' ';
    });
    var wordIndex = 0;
    var charIndex = 0;
    var currentText = '';
    element.classList.add("_opacity");
    function typeWord() {
      if (wordIndex === litArr.length) {
        element.classList.remove('typewriter-cursor');
        return;
      }
      var currentWord = textArray[wordIndex];
      if (currentWord === undefined) return;
      if (charIndex < currentWord.length) {
        currentText += currentWord.charAt(charIndex);
        element.innerText = currentText;
        charIndex++;
        setTimeout(typeWord, speed);
      } else {
        currentText += ' ';
        element.innerText = currentText;
        charIndex = 0;
        wordIndex++;
        setTimeout(typeWord, speed);
      }
    }
    element.classList.add('typewriter-cursor');
    typeWord();
  }
  function observeElements(typeElems) {
    var options = {
      root: null,
      threshold: 0.5
    };
    var observer = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry, i) {
        if (entry.isIntersecting) {
          dynamicTypewriter(entry.target, 35, function () {});
          observer.unobserve(entry.target);
        }
      });
    }, options);
    typeElems.forEach(function (item) {
      observer.observe(item);
    });
  }
  var typeAnim = document.querySelectorAll('.type-anim');
  observeElements(typeAnim);
  document.querySelector(".dark-btn").addEventListener("click", function () {
    document.body.classList.toggle("dark");
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhZ2VUYWJzIiwicXVlcnlTZWxlY3RvckFsbCIsInN0YWdlV3JhcHMiLCJsb3NlQ2FyZHMiLCJsb3NlQ2FyZHNUZWFtcyIsIndpbkNhcmRzIiwid2luQ2FyZHNUZWFtcyIsInByZWRpY3RPdmVybGF5IiwicXVlcnlTZWxlY3RvciIsInByZWRpY3RQb3B1cHMiLCJwcmVkaWN0VGVhbXMiLCJwcmVkaWN0QnRucyIsInByZWRpY3RMaXN0IiwicHJlZGljdExpc3RJdGVtIiwiY3VycmVudENhcmQiLCJzZXRQb3B1cCIsIm92ZXJsYXkiLCJidG5zIiwicG9wdXBzIiwiYnRuV3JhcHMiLCJmb3JFYWNoIiwiYnRuIiwiaSIsImUiLCJ0YXJnZXRDbGljayIsInByZWRpY3RCdG4iLCJzdG9yYWdlRGF0YSIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbmRleCIsIndyYXAiLCJzaG93UG9wdXAiLCJwb3B1cCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsImJvZHkiLCJzdHlsZSIsIm92ZXJmbG93IiwiY2xvc2VCdG4iLCJvbmNlIiwic2V0UG9wdXBXaW5Mb3NlIiwic2V0VGVhbSIsInRlYW1zIiwiY2FyZHNUZXh0Iiwic3RhdHVzIiwiY2FyZHMiLCJpdGVtIiwicHVzaCIsImNhcmQiLCJrZXkiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaW5uZXJIVE1MIiwiaW5uZXJUZXh0IiwidHJpbSIsInNldEF0dHJpYnV0ZSIsInRlYW0iLCJ0ZWFtTmFtZSIsInRleHRDb250ZW50Iiwic2V0SXRlbSIsImNhcmRzVGV4dExpc3RzIiwibGlzdCIsImxpc3RJbmRleCIsImNoaWxkTm9kZXMiLCJzdGFnZSIsInRlYW1UZXh0QmxvY2siLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlVGVhbSIsInJlbW92ZUJ0bnMiLCJsaXN0U3RhdGUiLCJyZW1vdmVCdG4iLCJidG5QYXJlbnQiLCJkYXRhQnRuIiwicmVtb3ZlSXRlbSIsInRhYiIsInRhYkluZGV4Iiwic3RhZ2VJbmRleCIsImNvbnRhaW5zIiwic3RhcnRDb3VudGRvd24iLCJlbGVtZW50IiwidGFyZ2V0RGF0ZSIsIkRhdGUiLCJ1cGRhdGVDb3VudGRvd24iLCJub3ciLCJkaWZmZXJlbmNlIiwiY2xlYXJJbnRlcnZhbCIsImNvdW50ZG93bkludGVydmFsIiwiZGF5cyIsIk1hdGgiLCJmbG9vciIsImhvdXJzIiwibWludXRlcyIsInNldEludGVydmFsIiwic2Nyb2xsQmFyIiwic2Nyb2xsQmFyVGh1bWIiLCJzY3JvbGxFbGVtIiwic2Nyb2xsQ29udGFpbmVyIiwic2Nyb2xsQmFyV2lkdGgiLCJjbGllbnRXaWR0aCIsInNjcm9sbEJhclRodW1iV2lkdGgiLCJkaXNwbGF5Iiwic2Nyb2xsV2lkdGgiLCJ3aWR0aCIsImN1cnJlbnRTY3JvbGxEaXN0YW5jZSIsInNjcm9sbExlZnQiLCJsZWZ0IiwiZHluYW1pY1R5cGV3cml0ZXIiLCJzcGVlZCIsImNhbGxiYWNrIiwidGV4dEFycmF5Iiwic3BsaXQiLCJsaXRBcnIiLCJqb2luIiwiZmlsdGVyIiwiX2NoYXIiLCJ3b3JkSW5kZXgiLCJjaGFySW5kZXgiLCJjdXJyZW50VGV4dCIsInR5cGVXb3JkIiwibGVuZ3RoIiwiY3VycmVudFdvcmQiLCJ1bmRlZmluZWQiLCJjaGFyQXQiLCJzZXRUaW1lb3V0Iiwib2JzZXJ2ZUVsZW1lbnRzIiwidHlwZUVsZW1zIiwib3B0aW9ucyIsInJvb3QiLCJ0aHJlc2hvbGQiLCJvYnNlcnZlciIsIkludGVyc2VjdGlvbk9ic2VydmVyIiwiZW50cmllcyIsImVudHJ5IiwiaXNJbnRlcnNlY3RpbmciLCJ1bm9ic2VydmUiLCJvYnNlcnZlIiwidHlwZUFuaW0iLCJ0b2dnbGUiXSwibWFwcGluZ3MiOiI7O0FBQUFBLFFBQVEsQ0FBQ0MsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsWUFBSTtFQUM5QyxJQUFNQyxT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U0FBUyxFQUFFO0lBQ2YsQ0FBQztJQUNELElBQU1DLFFBQVEsR0FBRyxJQUFJQyxvQkFBb0IsQ0FBQyxVQUFDQyxPQUFPLEVBQUVGLFFBQVEsRUFBSztNQUM3REUsT0FBTyxDQUFDbkgsT0FBTyxDQUFDLFVBQUNvSCxLQUFLLEVBQUVsSCxDQUFDLEVBQUs7UUFDMUIsSUFBSWtILEtBQUssQ0FBQ0MsY0FBYyxFQUFFO1VBQ3RCM0IsaUJBQWlCLENBQUMwQixLQUFLLENBQUM3RyxNQUFNLEVBQUUsRUFBRSxFQUFFLFlBQU0sQ0FBQyxDQUFDLENBQUM7VUFDN0MwRyxRQUFRLENBQUNLLFNBQVMsQ0FBQ0YsS0FBSyxDQUFDN0csTUFBTSxDQUFDO1FBQ3BDO01BQ0osQ0FBQyxDQUFDO0lBQ04sQ0FBQyxFQUFFdUcsT0FBTyxDQUFDO0lBQ1hELFNBQVMsQ0FBQzdHLE9BQU8sQ0FBQyxVQUFBNkIsSUFBSSxFQUFJO01BQ3RCb0YsUUFBUSxDQUFDTSxPQUFPLENBQUMxRixJQUFJLENBQUM7SUFDMUIsQ0FBQyxDQUFDO0VBQ047RUFDQSxJQUFNMkYsUUFBUSxHQUFHOUksUUFBUSxDQUFDRyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUM7RUFDeEQrSCxlQUFlLENBQUNZLFFBQVEsQ0FBQztFQUd6QjlJLFFBQVEsQ0FBQ1UsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDVCxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsWUFBSztJQUMvREQsUUFBUSxDQUFDd0MsSUFBSSxDQUFDSCxTQUFTLENBQUMwRyxNQUFNLENBQUMsTUFBTSxDQUFDO0VBQzFDLENBQUMsQ0FBQztBQUVOLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCk9PntcbiAgICBjb25zdCBzdGFnZVRhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3RhYnMtaXRlbVwiKSxcbiAgICAgICAgICBzdGFnZVdyYXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X19zdGFnZVwiKSxcbiAgICAgICAgICBsb3NlQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX2xvc2UtY2FyZFwiKSxcbiAgICAgICAgICBsb3NlQ2FyZHNUZWFtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbG9zZS10ZWFtXCIpLFxuICAgICAgICAgIHdpbkNhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X193aW4tY2FyZFwiKSxcbiAgICAgICAgICB3aW5DYXJkc1RlYW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X193aW4tdGVhbVwiKSxcbiAgICAgICAgICBwcmVkaWN0T3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJlZGljdF9fb3ZlcmxheVwiKSxcbiAgICAgICAgICBwcmVkaWN0UG9wdXBzID0gcHJlZGljdE92ZXJsYXkucXVlcnlTZWxlY3RvckFsbChcIi5wcmVkaWN0X190ZWFtc1wiKSxcbiAgICAgICAgICBwcmVkaWN0VGVhbXMgPSBwcmVkaWN0T3ZlcmxheS5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX3RlYW1zLWl0ZW1cIiksXG4gICAgICAgICAgcHJlZGljdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRzLWJ0blwiKSxcbiAgICAgICAgICBwcmVkaWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJlZGljdF9fbGlzdFwiKSxcbiAgICAgICAgICBwcmVkaWN0TGlzdEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZWRpY3RfX2xpc3QtaXRlbVwiKVxuXG4gICAgLy8gY29uc29sZS5sb2cocHJlZGljdEJ0bnMpXG5cbiAgICBsZXQgY3VycmVudENhcmQ7XG4gICAgLy8gbGV0IHNldFN0YXR1cztcblxuXG4gICAgZnVuY3Rpb24gc2V0UG9wdXAob3ZlcmxheSwgYnRucywgcG9wdXBzLCAgYnRuV3JhcHMpIHtcbiAgICAgICAgYnRucy5mb3JFYWNoKChidG4sIGkpID0+IHtcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcHJlZGljdEJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhcmRzLWJ0blwiKSxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2xpY2sgPSB0cnVlXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocHJlZGljdEJ0bnMpXG4gICAgICAgICAgICAgICAgcHJlZGljdEJ0bnMuZm9yRWFjaChwcmVkaWN0QnRuID0+e1xuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcmFnZURhdGEgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuICAgICAgICAgICAgICAgICAgICBpZihwcmVkaWN0QnRuID09PSBlLnRhcmdldCAmJiBzdG9yYWdlRGF0YSAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGljayA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRDbGlja1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYodGFyZ2V0Q2xpY2spe1xuICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGJ0bldyYXBzLmZvckVhY2goKHdyYXAsIGkpID0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYnRuLnBhcmVudEVsZW1lbnQgPT09IHdyYXApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmRleCA9IGlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgc2hvd1BvcHVwKHBvcHVwcywgb3ZlcmxheSwgaW5kZXgpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Q2FyZCA9IGJ0blxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXRQb3B1cChwcmVkaWN0T3ZlcmxheSwgcHJlZGljdExpc3RJdGVtLCBwcmVkaWN0UG9wdXBzLCBwcmVkaWN0TGlzdClcblxuXG4gICAgZnVuY3Rpb24gc2hvd1BvcHVwKHBvcHVwcywgb3ZlcmxheSwgaW5kZXgpe1xuICAgICAgICBwb3B1cHMuZm9yRWFjaChwb3B1cCA9PiBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKSk7XG4gICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIik7XG4gICAgICAgIHBvcHVwc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIik7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiXG4gICAgICAgIGNvbnN0IGNsb3NlQnRuID0gcG9wdXBzW2luZGV4XS5xdWVyeVNlbGVjdG9yKFwiLnByZWRpY3RfX3RlYW1zLWNsb3NlXCIpO1xuICAgICAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgIHBvcHVwc1tpbmRleF0uY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIik7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCJcbiAgICAgICAgfSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFBvcHVwV2luTG9zZShvdmVybGF5LCBidG5zLCBwb3B1cHMsIHByZWRpY3RCdG5zKSB7XG4gICAgICAgIGJ0bnMuZm9yRWFjaCgoYnRuLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB0YXJnZXRDbGljayA9IHRydWVcbiAgICAgICAgICAgICAgICBwcmVkaWN0QnRucy5mb3JFYWNoKHByZWRpY3RCdG4gPT57XG4gICAgICAgICAgICAgICAgICAgIGlmKHByZWRpY3RCdG4uY2xhc3NMaXN0ID09PSBlLnRhcmdldC5jbGFzc0xpc3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2xpY2sgPSBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRDbGlja1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYodGFyZ2V0Q2xpY2spe1xuICAgICAgICAgICAgICAgICAgICBzaG93UG9wdXAocG9wdXBzLCBvdmVybGF5LCBpbmRleClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRDYXJkID0gYnRuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRQb3B1cFdpbkxvc2UocHJlZGljdE92ZXJsYXksIHdpbkNhcmRzLCBwcmVkaWN0UG9wdXBzLCBwcmVkaWN0QnRucylcbiAgICBzZXRQb3B1cFdpbkxvc2UocHJlZGljdE92ZXJsYXksIGxvc2VDYXJkcywgcHJlZGljdFBvcHVwcywgcHJlZGljdEJ0bnMpXG5cblxuXG4gICAgZnVuY3Rpb24gc2V0VGVhbSh0ZWFtcywgY2FyZHNUZXh0LCBvdmVybGF5LCBwb3B1cHMsIHN0YXR1cykge1xuICAgICAgICBpZihzdGF0dXMpe1xuICAgICAgICAgICAgbGV0IGNhcmRzID0gW107XG4gICAgICAgICAgICBjYXJkc1RleHQuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICBjYXJkcy5wdXNoKGl0ZW0ucGFyZW50RWxlbWVudC5jbGFzc0xpc3RbMV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYXJkcy5mb3JFYWNoKChjYXJkLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IGBzZWxlY3RlZFRlYW0tJHtjYXJkfS0ke3N0YXR1c31gO1xuICAgICAgICAgICAgICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpe1xuICAgICAgICAgICAgICAgICAgICBjYXJkc1RleHRbaV0uaW5uZXJIVE1MID0gYNCa0L7QvNCw0L3QtNCwIDxicj4gJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpfWA7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRzVGV4dFtpXS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZHNUZXh0W2ldLmlubmVyVGV4dC50cmltKCkgIT09ICcnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzVGV4dFtpXS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzVGV4dFtpXS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXN0b3JhZ2UnLCBrZXkpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGVhbXMuZm9yRWFjaCgodGVhbSkgPT4ge1xuICAgICAgICAgICAgICAgIHRlYW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0IHRlYW1QYXJlbnQgPSB0ZWFtLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVhbU5hbWUgPSB0ZWFtLnF1ZXJ5U2VsZWN0b3IoXCIudGVhbS1uYW1lXCIpLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBjYXJkcy5mb3JFYWNoKChjYXJkLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENhcmQgPT09IGNhcmRzVGV4dFtpXS5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IGBzZWxlY3RlZFRlYW0tJHtjYXJkfS0ke3N0YXR1c31gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXJkLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2FyZC5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yYWdlJywga2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgYCR7dGVhbU5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNUZXh0W2ldLmlubmVySFRNTCA9IGDQmtC+0LzQsNC90LTQsCA8YnI+ICR7dGVhbU5hbWV9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwcy5mb3JFYWNoKHBvcHVwID0+IHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJhdXRvXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgbGV0IGNhcmRzVGV4dExpc3RzID0gW11cbiAgICAgICAgICAgIGNhcmRzVGV4dC5mb3JFYWNoKGl0ZW0gPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRzVGV4dExpc3RzLnB1c2goaXRlbSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjYXJkc1RleHRMaXN0cy5mb3JFYWNoKChsaXN0LCBsaXN0SW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBsaXN0LmNoaWxkTm9kZXMuZm9yRWFjaCgoaXRlbSwgaSkgPT57XG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFnZSA9IGxpc3QuZ2V0QXR0cmlidXRlKFwiZGF0YS1zdGFnZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGBzZWxlY3RlZFRlYW0tJHtzdGFnZX0tY2FyZCR7KytpfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZWFtVGV4dEJsb2NrID0gaXRlbS5xdWVyeVNlbGVjdG9yKGAuJHtpdGVtLmNsYXNzTGlzdFswXX0tdGVhbWApXG4gICAgICAgICAgICAgICAgICAgIHRlYW1zLmZvckVhY2goKHRlYW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlYW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbSA9PT0gY3VycmVudENhcmQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtTmFtZSA9IHRlYW0ucXVlcnlTZWxlY3RvcihcIi50ZWFtLW5hbWVcIikudGV4dENvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENhcmQuY2xhc3NMaXN0LmFkZChcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENhcmQuc2V0QXR0cmlidXRlKCdkYXRhLXN0b3JhZ2UnLCBrZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgYCR7dGVhbU5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGl0ZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2suaW5uZXJIVE1MID0gYNCa0L7QvNCw0L3QtNCwIDxicj4gJHt0ZWFtTmFtZX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJfYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cHMuZm9yRWFjaChwb3B1cCA9PiBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiX2FjdGl2ZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImF1dG9cIlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwia2V5XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZWFtVGV4dEJsb2NrLmlubmVySFRNTCA9IGDQmtC+0LzQsNC90LTQsCA8YnI+ICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVhbVRleHRCbG9jay5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIl9zZWxlY3RcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlYW1UZXh0QmxvY2suaW5uZXJUZXh0LnRyaW0oKSAhPT0gJycpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2sucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiX3NlbGVjdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlYW1UZXh0QmxvY2sucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RvcmFnZScsIGtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBzZXRUZWFtKHByZWRpY3RUZWFtcywgd2luQ2FyZHNUZWFtcywgcHJlZGljdE92ZXJsYXksIHByZWRpY3RQb3B1cHMsIFwid2luXCIpO1xuICAgIHNldFRlYW0ocHJlZGljdFRlYW1zLCBsb3NlQ2FyZHNUZWFtcywgcHJlZGljdE92ZXJsYXksIHByZWRpY3RQb3B1cHMsIFwibG9zZVwiKTtcbiAgICBzZXRUZWFtKHByZWRpY3RUZWFtcywgcHJlZGljdExpc3QsIHByZWRpY3RPdmVybGF5LCBwcmVkaWN0UG9wdXBzLCBudWxsKTtcblxuICAgIGZ1bmN0aW9uIHJlbW92ZVRlYW0ocmVtb3ZlQnRucywgbGlzdFN0YXRlKXtcbiAgICAgICAgcmVtb3ZlQnRucy5mb3JFYWNoKHJlbW92ZUJ0biA9PntcbiAgICAgICAgICAgIHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgICAgICAgICAgICAgbGV0IGJ0blBhcmVudCA9ICByZW1vdmVCdG4ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICBkYXRhQnRuID0gYnRuUGFyZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc3RvcmFnZVwiKVxuXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YUJ0bilcbiAgICAgICAgICAgICAgICBpZighZGF0YUJ0bil7XG4gICAgICAgICAgICAgICAgICAgIGJ0blBhcmVudCA9IHJlbW92ZUJ0bi5wYXJlbnRFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIGRhdGFCdG4gPSBidG5QYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zdG9yYWdlXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGRhdGFCdG4pXG4gICAgICAgICAgICAgICAgYnRuUGFyZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJfc2VsZWN0XCIpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlVGVhbShwcmVkaWN0QnRucylcbiAgICByZW1vdmVUZWFtKHByZWRpY3RCdG5zKVxuXG4gICAgc3RhZ2VUYWJzLmZvckVhY2goKHRhYiwgdGFiSW5kZXgpID0+e1xuICAgICAgICB0YWIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PntcbiAgICAgICAgICAgIHN0YWdlVGFicy5mb3JFYWNoKCh0YWIsIGkpID0+e1xuICAgICAgICAgICAgICB0YWIuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBzdGFnZVdyYXBzLmZvckVhY2goKGl0ZW0sIHN0YWdlSW5kZXgpID0+e1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIilcbiAgICAgICAgICAgICAgICBpZih0YWJJbmRleCA9PT0gc3RhZ2VJbmRleCl7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIilcbiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJzdGFnZTNcIikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3N0YWdlMycpXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3N0YWdlMycpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZChcIl9hY3RpdmVcIilcbiAgICAgICAgfSlcbiAgICB9KVxuXG4vLyBjb3VudGRvd24gdGltZXJcbiAgICBmdW5jdGlvbiBzdGFydENvdW50ZG93bihlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHRhcmdldERhdGUgPSBuZXcgRGF0ZShlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQtZGF0ZScpKVxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVDb3VudGRvd24oKSB7XG4gICAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRhcmdldERhdGUgLSBub3dcbiAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlIDw9IDApIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVkaWN0X19pbmZvLWxvY2stY291bnRkb3duJykudGV4dENvbnRlbnQgPSBcInRpbWUgb3ZlclwiXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjb3VudGRvd25JbnRlcnZhbClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRheXMgPSBNYXRoLmZsb29yKGRpZmZlcmVuY2UgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpLFxuICAgICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLmZsb29yKChkaWZmZXJlbmNlICUgKDEwMDAgKiA2MCAqIDYwICogMjQpKSAvICgxMDAwICogNjAgKiA2MCkpLFxuICAgICAgICAgICAgICAgICAgbWludXRlcyA9IE1hdGguZmxvb3IoKGRpZmZlcmVuY2UgJSAoMTAwMCAqIDYwICogNjApKSAvICgxMDAwICogNjApKVxuICAgICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucHJlZGljdF9faW5mby1sb2NrLWRheXMnKS50ZXh0Q29udGVudCA9IGRheXNcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZWRpY3RfX2luZm8tbG9jay1ob3VycycpLnRleHRDb250ZW50ID0gaG91cnNcbiAgICAgICAgICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZWRpY3RfX2luZm8tbG9jay1taW51dGVzJykudGV4dENvbnRlbnQgPSBtaW51dGVzXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY291bnRkb3duSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh1cGRhdGVDb3VudGRvd24sIDYwMDAwKVxuICAgICAgICB1cGRhdGVDb3VudGRvd24oKVxuICAgIH1cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJlZGljdF9faW5mby1sb2NrLWNvdW50ZG93bicpLmZvckVhY2goc3RhcnRDb3VudGRvd24pXG5cbiAgICAvLyBjdXN0b20gaG9yaXpvbnRhbCBzY3JvbGxcbiAgICBjb25zdCBzY3JvbGxCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19zY3JvbGxiYXJcIiksXG4gICAgICAgICAgc2Nyb2xsQmFyVGh1bWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYmxlX19zY3JvbGxiYXItdGh1bWJcIiksXG4gICAgICAgICAgc2Nyb2xsRWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YWJsZV9fd3JhcC1zY3JvbGwnKSxcbiAgICAgICAgICBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFibGVfX3dyYXAnKVxuXG4gICAgbGV0IHNjcm9sbEJhcldpZHRoID0gc2Nyb2xsQ29udGFpbmVyLmNsaWVudFdpZHRoIC0gNTAsXG4gICAgICAgIHNjcm9sbEJhclRodW1iV2lkdGg7XG5cbiAgICBpZiAoc2Nyb2xsRWxlbS5jbGllbnRXaWR0aCA8PSBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGgpIHtcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgIH0gZWxzZSB7XG4gICAgICAgIHNjcm9sbEJhci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiXG4gICAgICAgIHNjcm9sbEJhclRodW1iV2lkdGggPSAoc2Nyb2xsQmFyV2lkdGggKiBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGggLSA1MCkgLyBzY3JvbGxFbGVtLnNjcm9sbFdpZHRoXG4gICAgICAgIHNjcm9sbEJhclRodW1iLnN0eWxlLndpZHRoID0gYCR7c2Nyb2xsQmFyVGh1bWJXaWR0aH1weGBcbiAgICAgICAgc2Nyb2xsQmFyLnN0eWxlLndpZHRoID0gYCR7c2Nyb2xsQmFyV2lkdGh9cHhgXG4gICAgfVxuXG4gICAgbGV0IGN1cnJlbnRTY3JvbGxEaXN0YW5jZSA9IDBcblxuICAgIHNjcm9sbENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsICgpID0+IHtcbiAgICAgICAgY3VycmVudFNjcm9sbERpc3RhbmNlID0gKHNjcm9sbENvbnRhaW5lci5zY3JvbGxMZWZ0ICogMTAwKSAvIHNjcm9sbENvbnRhaW5lci5jbGllbnRXaWR0aFxuICAgICAgICBzY3JvbGxCYXJUaHVtYi5zdHlsZS5sZWZ0ID0gYCR7KHNjcm9sbEJhclRodW1iV2lkdGggLyAxMDApICogY3VycmVudFNjcm9sbERpc3RhbmNlIC0gNX1weGBcbiAgICB9KTtcbi8vIHR5cGV3cmlnaHQgdGV4dCBhbmltXG4gICAgZnVuY3Rpb24gZHluYW1pY1R5cGV3cml0ZXIoZWxlbWVudCwgc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IHRleHRBcnJheSA9IGVsZW1lbnQudGV4dENvbnRlbnQudHJpbSgpLnNwbGl0KCcgJyk7XG4gICAgICAgIGNvbnN0IGxpdEFyciA9IHRleHRBcnJheS5qb2luKCcgJykuc3BsaXQoLyhcXHMrKS8pLmZpbHRlcihmdW5jdGlvbiAoX2NoYXIpIHtcbiAgICAgICAgICAgIHJldHVybiBfY2hhci50cmltKCkgIT09ICcnIHx8IF9jaGFyID09PSAnICc7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgd29yZEluZGV4ID0gMDtcbiAgICAgICAgbGV0IGNoYXJJbmRleCA9IDA7XG4gICAgICAgIGxldCBjdXJyZW50VGV4dCA9ICcnO1xuXG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIl9vcGFjaXR5XCIpXG5cbiAgICAgICAgZnVuY3Rpb24gdHlwZVdvcmQoKSB7XG4gICAgICAgICAgICBpZiAod29yZEluZGV4ID09PSBsaXRBcnIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCd0eXBld3JpdGVyLWN1cnNvcicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRXb3JkID0gdGV4dEFycmF5W3dvcmRJbmRleF07XG5cbiAgICAgICAgICAgIGlmKGN1cnJlbnRXb3JkID09PSB1bmRlZmluZWQpIHJldHVyblxuXG4gICAgICAgICAgICBpZiAoY2hhckluZGV4IDwgY3VycmVudFdvcmQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFRleHQgKz0gY3VycmVudFdvcmQuY2hhckF0KGNoYXJJbmRleCk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lclRleHQgPSBjdXJyZW50VGV4dDtcbiAgICAgICAgICAgICAgICBjaGFySW5kZXgrKztcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHR5cGVXb3JkLCBzcGVlZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRUZXh0ICs9ICcgJztcbiAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVyVGV4dCA9IGN1cnJlbnRUZXh0O1xuICAgICAgICAgICAgICAgIGNoYXJJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgd29yZEluZGV4Kys7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCh0eXBlV29yZCwgc3BlZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndHlwZXdyaXRlci1jdXJzb3InKTtcbiAgICAgICAgdHlwZVdvcmQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvYnNlcnZlRWxlbWVudHModHlwZUVsZW1zKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICByb290OiBudWxsLFxuICAgICAgICAgICAgdGhyZXNob2xkOiAwLjVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGVudHJpZXMsIG9ic2VydmVyKSA9PiB7XG4gICAgICAgICAgICBlbnRyaWVzLmZvckVhY2goKGVudHJ5LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGR5bmFtaWNUeXBld3JpdGVyKGVudHJ5LnRhcmdldCwgMzUsICgpID0+IHt9KTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIudW5vYnNlcnZlKGVudHJ5LnRhcmdldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIG9wdGlvbnMpO1xuICAgICAgICB0eXBlRWxlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB0eXBlQW5pbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50eXBlLWFuaW0nKTtcbiAgICBvYnNlcnZlRWxlbWVudHModHlwZUFuaW0pO1xuXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhcmstYnRuXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKFwiZGFya1wiKVxuICAgIH0pXG5cbn0pXG5cblxuXG4iXX0=
